  0: <span class='def-Comment def-Syntax'>#!</span><span class='def-VarStrong def-Var'>./perl</span><span class='def-KeywordStrong def-Keyword'> -T</span>
  1: <span class='perl-Comment def-Comment def-Syntax'>#</span>
  2: <span class='perl-Comment def-Comment def-Syntax'># Taint tests by Tom Phoenix </span><span class='def-String'>&lt;</span><span class='def-EMail def-URI'>rootbeer@teleport.com</span><span class='def-String'>></span><span class='perl-Comment def-Comment def-Syntax'>.</span>
  3: <span class='perl-Comment def-Comment def-Syntax'>#</span>
  4: <span class='perl-Comment def-Comment def-Syntax'># I don't claim to know all about tainting. If anyone sees</span>
  5: <span class='perl-Comment def-Comment def-Syntax'># tests that I've missed here, please add them. But this is</span>
  6: <span class='perl-Comment def-Comment def-Syntax'># better than having no tests at all, right?</span>
  7: <span class='perl-Comment def-Comment def-Syntax'>#</span>
  8: 
  9: <span class='perl-Word def-Keyword'>BEGIN</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 10:     <span class='perl-Word def-Keyword'>chdir</span> <span class='perl-String def-String'>'t'</span> <span class='perl-Word def-Keyword'>if</span> <span class='perl-Word def-Keyword'>-d</span> <span class='perl-String def-String'>'t'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 11:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unshift</span> <span class='perl-Var def-Var'>@INC</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'../lib'</span> <span class='perl-Word def-Keyword'>if</span> <span class='perl-Word def-Keyword'>-d</span> <span class='perl-String def-String'>'../lib'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 12: <span class='def-SymbolStrong def-Symbol'>}</span>
 13: 
 14: <span class='perl-Word def-Keyword'>use</span> <span class='perl-packages-pragmas perl-Word def-Keyword'>strict</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 15: <span class='perl-Word def-Keyword'>use</span> <span class='perl-packages perl-WordExt def-KeywordStrong def-Keyword'>Config</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 16: 
 17: <span class='perl-Comment def-Comment def-Syntax'># We do not want the whole taint.t to fail</span>
 18: <span class='perl-Comment def-Comment def-Syntax'># just because Errno possibly failing.</span>
 19: <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>require</span> <span class='perl-packages perl-WordExt def-KeywordStrong def-Keyword'>Errno</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> import <span class='perl-packages perl-WordExt def-KeywordStrong def-Keyword'>Errno</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 20: 
 21: <span class='perl-Word def-Keyword'>BEGIN</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 22:   <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'VMS'</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Symb def-Symbol'>!</span><span class='perl-Word def-Keyword'>defined</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_setenv</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 23:       <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>PATH</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>PATH</span><span class='perl-Symb def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 24:       <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>TERM</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>TERM</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>ne</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>?</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>TERM</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>:</span> <span class='perl-String def-String'>'dummy'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 25:   <span class='def-SymbolStrong def-Symbol'>}</span>
 26:   <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_shm</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_msg</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 27:      <span class='perl-Word def-Keyword'>require</span> <span class='perl-packages-user def-Directive'>IPC</span><span class='perl-Symb def-Symbol'>::</span><span class='perl-packages-user def-Directive'>SysV</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 28:      <span class='perl-packages perl-WordExt def-KeywordStrong def-Keyword'>IPC</span><span class='perl-Symb def-Symbol'>::</span><span class='perl-packages perl-WordExt def-KeywordStrong def-Keyword'>SysV</span><span class='perl-Symb def-Symbol'>-></span>import<span class='def-Symbol'>(</span><span class='perl-ReType perl-Word def-Keyword'>qw</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>(</span><span class='perl-String def-String'>IPC_PRIVATE IPC_RMID IPC_CREAT S_IRWXU</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>)</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 29:   <span class='def-SymbolStrong def-Symbol'>}</span>
 30: <span class='def-SymbolStrong def-Symbol'>}</span>
 31: 
 32: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$Is_VMS</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'VMS'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 33: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$Is_MSWin32</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'MSWin32'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 34: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$Is_Dos</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'dos'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 35: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$Invoke_Perl</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$Is_VMS</span> <span class='perl-Symb def-Symbol'>?</span> <span class='perl-String def-String'>'MCR Sys$Disk:[]Perl.'</span> <span class='perl-Symb def-Symbol'>:</span>
 36:                   <span class='perl-Var def-Var'>$Is_MSWin32</span> <span class='perl-Symb def-Symbol'>?</span> <span class='perl-String def-String'>'.\perl'</span> <span class='perl-Symb def-Symbol'>:</span> <span class='perl-String def-String'>'./perl'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 37: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@MoreEnv</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-ReType perl-Word def-Keyword'>qw</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-String def-String'>IFS CDPATH ENV BASH_ENV</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 38: 
 39: <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Is_VMS</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 40:     <span class='perl-Word def-Keyword'>my</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>%old</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$x</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 41:     <span class='perl-Word def-Keyword'>for</span> <span class='perl-Var def-Var'>$x</span> <span class='def-Symbol'>(</span><span class='perl-String def-String'>'DCL$PATH'</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>@MoreEnv</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 42:     <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$old</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>$x</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>$x</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>*</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='regexp-MetaSymb def-Symbol'>$</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span> <span class='perl-Word def-Keyword'>if</span> <span class='perl-Word def-Keyword'>exists</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>$x</span><span class='perl-Symb def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 43:     <span class='def-SymbolStrong def-Symbol'>}</span>
 44: <span class='def-Text'>    </span><span class='perl-Word def-Keyword'>eval</span><span class='def-Text'> </span><span class='perl-HereDocLt perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>&lt;&lt;</span><span class='perl-HereDocName def-Label'>EndOfCleanup</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span><span class='perl-HereDoc perl-String def-String'></span>
 45: <span class='perl-HereDoc perl-String def-String'>    END {</span>
 46: <span class='perl-HereDoc perl-String def-String'>        </span><span class='perl-Slash def-StringContent def-String'>\$</span><span class='perl-HereDoc perl-String def-String'>ENV{PATH} = '' if </span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_setenv</span><span class='perl-Symb def-Symbol'>}</span><span class='perl-HereDoc perl-String def-String'>;</span>
 47: <span class='perl-HereDoc perl-String def-String'>        warn "# Note: logical name 'PATH' may have been deleted</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-HereDoc perl-String def-String'>";</span>
 48: <span class='perl-HereDoc perl-String def-String'>        </span><span class='perl-Slash def-StringContent def-String'>\@</span><span class='perl-HereDoc perl-String def-String'>ENV{keys %old} = values %old;</span>
 49: <span class='perl-HereDoc perl-String def-String'>    }</span>
 50: <span class='perl-HereDocName def-Label'>EndOfCleanup</span>
 51: <span class='def-SymbolStrong def-Symbol'>}</span>
 52: 
 53: <span class='perl-Comment def-Comment def-Syntax'># Sources of taint:</span>
 54: <span class='perl-Comment def-Comment def-Syntax'>#   The empty tainted value, for tainting strings</span>
 55: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>substr</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$^X</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 56: <span class='perl-Comment def-Comment def-Syntax'>#   A tainted zero, useful for tainting numbers</span>
 57: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$TAINT0</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>0</span> <span class='perl-Symb def-Symbol'>+</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 58: 
 59: <span class='perl-Comment def-Comment def-Syntax'># This taints each argument passed. All must be lvalues.</span>
 60: <span class='perl-Comment def-Comment def-Syntax'># Side effect: It also stringifies them. :-(</span>
 61: <span class='perl-Word def-Keyword'>sub</span> taint_these <span class='perl-Symb def-Symbol'>(</span><span class='perl-SubProt perl-Var def-Var'>@</span><span class='perl-Symb def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 62:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>@_</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Var def-Var'>$_</span> <span class='perl-Symb def-Symbol'>.</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span>
 63: <span class='def-SymbolStrong def-Symbol'>}</span>
 64: 
 65: <span class='perl-Comment def-Comment def-Syntax'># How to identify taint when you see it</span>
 66: <span class='perl-Word def-Keyword'>sub</span> any_tainted <span class='perl-Symb def-Symbol'>(</span><span class='perl-SubProt perl-Var def-Var'>@</span><span class='perl-Symb def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 67:     <span class='perl-Symb def-Symbol'>not</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>join</span><span class='def-Symbol'>(</span><span class='perl-String def-String'>""</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Var def-Var'>@_</span><span class='def-Symbol'>)</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>kill</span> <span class='perl-Numb def-Number'>0</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> <span class='perl-Numb def-Number'>1</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 68: <span class='def-SymbolStrong def-Symbol'>}</span>
 69: <span class='perl-Word def-Keyword'>sub</span> tainted <span class='perl-Symb def-Symbol'>(</span><span class='perl-SubProt perl-Var def-Var'>$</span><span class='perl-Symb def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 70:     any_tainted <span class='perl-Var def-Var'>@_</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 71: <span class='def-SymbolStrong def-Symbol'>}</span>
 72: <span class='perl-Word def-Keyword'>sub</span> all_tainted <span class='perl-Symb def-Symbol'>(</span><span class='perl-SubProt perl-Var def-Var'>@</span><span class='perl-Symb def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 73:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>@_</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>return</span> <span class='perl-Numb def-Number'>0</span> <span class='perl-Word def-Keyword'>unless</span> tainted <span class='perl-Var def-Var'>$_</span> <span class='def-SymbolStrong def-Symbol'>}</span>
 74:     <span class='perl-Numb def-Number'>1</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 75: <span class='def-SymbolStrong def-Symbol'>}</span>
 76: 
 77: <span class='perl-Word def-Keyword'>sub</span> test <span class='perl-Symb def-Symbol'>(</span><span class='perl-SubProt perl-Var def-Var'>$</span><span class='perl-SubProt perl-Var def-Var'>$</span><span class='perl-Symb def-Symbol'>;</span><span class='perl-SubProt perl-Var def-Var'>$</span><span class='perl-Symb def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 78:     <span class='perl-Word def-Keyword'>my</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$serial</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$boolean</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$diag</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>@_</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 79:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$boolean</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 80:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$serial</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 81:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 82:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"not ok </span><span class='perl-Var def-Var'>$serial</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 83:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Word def-Keyword'>split</span> <span class='perl-ReType perl-Word def-Keyword'>m</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-ReModif regexp-SpecArea def-Keyword'>m</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$diag</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 84:         <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"# </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 85:     <span class='def-SymbolStrong def-Symbol'>}</span>
 86:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='perl-Word def-Keyword'>unless</span>
 87:         <span class='perl-Var def-Var'>$diag</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span>
 88:         <span class='perl-Symb def-Symbol'>or</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>substr</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$diag</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>-</span><span class='perl-Numb def-Number'>1</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>"</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 89:     <span class='def-SymbolStrong def-Symbol'>}</span>
 90: <span class='def-SymbolStrong def-Symbol'>}</span>
 91: 
 92: <span class='perl-Comment def-Comment def-Syntax'># We need an external program to call.</span>
 93: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$ECHO</span> <span class='perl-Symb def-Symbol'>=</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Is_MSWin32</span> <span class='perl-Symb def-Symbol'>?</span> <span class='perl-String def-String'>".</span><span class='perl-Slash def-StringContent def-String'>\\</span><span class='perl-String def-String'>echo</span><span class='perl-Var def-Var'>$$</span><span class='perl-String def-String'>"</span> <span class='perl-Symb def-Symbol'>:</span> <span class='perl-String def-String'>"./echo</span><span class='perl-Var def-Var'>$$</span><span class='perl-String def-String'>"</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 94: <span class='perl-Word def-Keyword'>END</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span> <span class='perl-Var def-Var'>$ECHO</span> <span class='def-SymbolStrong def-Symbol'>}</span>
 95: <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span> PROG<span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"> </span><span class='perl-Var def-Var'>$ECHO</span><span class='perl-String def-String'>"</span> <span class='perl-Symb def-Symbol'>or</span> <span class='perl-Word def-Keyword'>die</span> <span class='perl-String def-String'>"Can't create </span><span class='perl-Var def-Var'>$ECHO</span><span class='perl-String def-String'>: </span><span class='perl-Var def-Var'>$!</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 96: <span class='perl-Word def-Keyword'>print</span> PROG <span class='perl-String def-String'>'print "@ARGV\n"'</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 97: <span class='perl-WordFun def-FunctionKeyword def-Keyword'>close</span> PROG<span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 98: <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$echo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"</span><span class='perl-Var def-Var'>$Invoke_Perl</span><span class='perl-String def-String'> </span><span class='perl-Var def-Var'>$ECHO</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
 99: 
100: <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"</span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>.</span><span class='def-NumberFloat def-Number'>.151</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
101: 
102: <span class='perl-Comment def-Comment def-Syntax'># First, let's make sure that Perl is checking the dangerous</span>
103: <span class='perl-Comment def-Comment def-Syntax'># environment variables. Maybe they aren't set yet, so we'll</span>
104: <span class='perl-Comment def-Comment def-Syntax'># taint them ourselves.</span>
105: <span class='def-SymbolStrong def-Symbol'>{</span>
106:     <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-String def-String'>'DCL$PATH'</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>''</span> <span class='perl-Word def-Keyword'>if</span> <span class='perl-Var def-Var'>$Is_VMS</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
107: 
108:     <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>PATH</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>''</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
109:     <span class='perl-Word def-Keyword'>delete</span> <span class='perl-Var def-Var'>@ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>@MoreEnv</span><span class='perl-Symb def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
110:     <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>TERM</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>'dumb'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
111: 
112:     test <span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>"</span><span class='def-NumberDec def-Number'>1</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
113: 
114:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Is_MSWin32</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$Is_VMS</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$Is_Dos</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
115:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"# Environment tainting tests skipped</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
116:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>5</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
117:     <span class='def-SymbolStrong def-Symbol'>}</span>
118:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
119:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@vars</span> <span class='perl-Symb def-Symbol'>=</span> <span class='def-Symbol'>(</span><span class='perl-String def-String'>'PATH'</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>@MoreEnv</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
120:     <span class='perl-Word def-Keyword'>while</span> <span class='def-Symbol'>(</span><span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$v</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$vars</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
121:         <span class='perl-Word def-Keyword'>local</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>$v</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
122:         <span class='perl-Word def-Keyword'>last</span> <span class='perl-Word def-Keyword'>if</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
123:         <span class='perl-Word def-Keyword'>last</span> <span class='perl-Word def-Keyword'>unless</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure </span><span class='regexp-Symbol def-StringContent def-String'>\$</span><span class='perl-String def-String'>ENV{</span><span class='perl-Var def-Var'>$v</span><span class='perl-String def-String'>}</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
124:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>shift</span> <span class='perl-Var def-Var'>@vars</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
125:     <span class='def-SymbolStrong def-Symbol'>}</span>
126:     test <span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>!</span><span class='perl-Var def-Var'>@vars</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"</span><span class='perl-Slash def-StringContent def-String'>\$</span><span class='perl-Var def-Var'>$vars</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
127: 
128:     <span class='perl-Comment def-Comment def-Syntax'># tainted $TERM is unsafe only if it contains metachars</span>
129:     <span class='perl-Word def-Keyword'>local</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>TERM</span><span class='perl-Symb def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
130:     <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>TERM</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>'e=mc2'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
131:     test <span class='perl-Numb def-Number'>3</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>"</span><span class='def-NumberDec def-Number'>1</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
132:     <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>TERM</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>'e=mc2'</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
133:     test <span class='perl-Numb def-Number'>4</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
134:     test <span class='perl-Numb def-Number'>5</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure </span><span class='regexp-Symbol def-StringContent def-String'>\$</span><span class='perl-String def-String'>ENV</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>{</span><span class='def-Number'>TERM</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>}</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
135:     <span class='def-SymbolStrong def-Symbol'>}</span>
136: 
137:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$tmp</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
138:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'os2'</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'amigaos'</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$Is_MSWin32</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$Is_Dos</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
139:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"# all directories are writeable</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
140:     <span class='def-SymbolStrong def-Symbol'>}</span>
141:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
142:     <span class='perl-Var def-Var'>$tmp</span> <span class='perl-Symb def-Symbol'>=</span> <span class='def-Symbol'>(</span><span class='perl-Word def-Keyword'>grep</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>defined</span> <span class='perl-Symb def-Symbol'>and</span> <span class='perl-Word def-Keyword'>-d</span> <span class='perl-Symb def-Symbol'>and</span> <span class='def-Symbol'>(</span><span class='perl-Word def-Keyword'>stat</span> _<span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='def-Symbol'>]</span> <span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Numb def-Number'>2</span> <span class='def-SymbolStrong def-Symbol'>}</span>
143:              <span class='perl-ReType perl-Word def-Keyword'>qw</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>(</span><span class='perl-String def-String'>sys$scratch /tmp /var/tmp /usr/tmp</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>)</span><span class='perl-Symb def-Symbol'>,</span>
144:              <span class='perl-Var def-Var'>@ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-ReType perl-Word def-Keyword'>qw</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>(</span><span class='perl-String def-String'>TMP TEMP</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>)</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>]</span>
145:         <span class='perl-Symb def-Symbol'>or</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"# can't find world-writeable directory to test PATH</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
146:     <span class='def-SymbolStrong def-Symbol'>}</span>
147: 
148:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$tmp</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
149:     <span class='perl-Word def-Keyword'>local</span> <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>PATH</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$tmp</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
150:     test <span class='perl-Numb def-Number'>6</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
151:     test <span class='perl-Numb def-Number'>7</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure directory in </span><span class='regexp-Symbol def-StringContent def-String'>\$</span><span class='perl-String def-String'>ENV</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>{</span><span class='def-Number'>PATH</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>}</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
152:     <span class='def-SymbolStrong def-Symbol'>}</span>
153:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
154:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>6</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>7</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: all directories are writeable</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
155:     <span class='def-SymbolStrong def-Symbol'>}</span>
156: 
157:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Is_VMS</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
158:     <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-String def-String'>'DCL$PATH'</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
159:     test <span class='perl-Numb def-Number'>8</span><span class='perl-Symb def-Symbol'>,</span>  <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
160:     test <span class='perl-Numb def-Number'>9</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure </span><span class='regexp-Symbol def-StringContent def-String'>\$</span><span class='perl-String def-String'>ENV{DCL</span><span class='regexp-Symbol def-StringContent def-String'>\$</span><span class='perl-String def-String'>PATH}</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
161:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$tmp</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
162:         <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-String def-String'>'DCL$PATH'</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$tmp</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
163:         test <span class='perl-Numb def-Number'>10</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
164:         test <span class='perl-Numb def-Number'>11</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure directory in </span><span class='regexp-Symbol def-StringContent def-String'>\$</span><span class='perl-String def-String'>ENV{DCL</span><span class='regexp-Symbol def-StringContent def-String'>\$</span><span class='perl-String def-String'>PATH}</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
165:     <span class='def-SymbolStrong def-Symbol'>}</span>
166:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
167:         <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>10</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>11</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: can't find world-writeable directory to test DCL</span><span class='perl-Slash def-StringContent def-String'>\$</span><span class='perl-String def-String'>PATH</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
168:     <span class='def-SymbolStrong def-Symbol'>}</span>
169:     <span class='perl-Var def-Var'>$ENV</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-String def-String'>'DCL$PATH'</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>''</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
170:     <span class='def-SymbolStrong def-Symbol'>}</span>
171:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
172:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>8</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>11</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: This is not VMS</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> <span class='def-SymbolStrong def-Symbol'>}</span>
173:     <span class='def-SymbolStrong def-Symbol'>}</span>
174: <span class='def-SymbolStrong def-Symbol'>}</span>
175: 
176: <span class='perl-Comment def-Comment def-Syntax'># Let's see that we can taint and untaint as needed.</span>
177: <span class='def-SymbolStrong def-Symbol'>{</span>
178:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
179:     test <span class='perl-Numb def-Number'>12</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
180: 
181:     <span class='perl-Comment def-Comment def-Syntax'># That was a sanity check. If it failed, stop the insanity!</span>
182:     <span class='perl-Word def-Keyword'>die</span> <span class='perl-String def-String'>"Taint checks don't seem to be enabled"</span> <span class='perl-Word def-Keyword'>unless</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
183: 
184:     <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"foo"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
185:     test <span class='perl-Numb def-Number'>13</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
186: 
187:     taint_these<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$foo</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
188:     test <span class='perl-Numb def-Number'>14</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
189: 
190:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@list</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>10</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
191:     test <span class='perl-Numb def-Number'>15</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> any_tainted <span class='perl-Var def-Var'>@list</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
192:     taint_these <span class='perl-Var def-Var'>@list</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>3</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>5</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>7</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>9</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
193:     test <span class='perl-Numb def-Number'>16</span><span class='perl-Symb def-Symbol'>,</span> any_tainted <span class='perl-Var def-Var'>@list</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
194:     test <span class='perl-Numb def-Number'>17</span><span class='perl-Symb def-Symbol'>,</span> all_tainted <span class='perl-Var def-Var'>@list</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>3</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>5</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>7</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>9</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
195:     test <span class='perl-Numb def-Number'>18</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> any_tainted <span class='perl-Var def-Var'>@list</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>4</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>6</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>8</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
196: 
197:     <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$foo</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>+</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
198:     test <span class='perl-Numb def-Number'>19</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
199: 
200:     <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$1</span> <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-String def-String'>'bar'</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>+</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
201:     test <span class='perl-Numb def-Number'>20</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
202:     test <span class='perl-Numb def-Number'>21</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'bar'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
203: 
204:     <span class='def-SymbolStrong def-Symbol'>{</span>
205:       <span class='perl-Word def-Keyword'>use</span> <span class='perl-packages-pragmas perl-Word def-Keyword'>re</span> <span class='perl-String def-String'>'taint'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
206: 
207:       <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$foo</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span> <span class='def-Symbol'>(</span><span class='perl-String def-String'>'bar'</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>+</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
208:       test <span class='perl-Numb def-Number'>22</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
209:       test <span class='perl-Numb def-Number'>23</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'bar'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
210: 
211:       <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$1</span> <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-String def-String'>'bar'</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>+</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
212:       test <span class='perl-Numb def-Number'>24</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
213:       test <span class='perl-Numb def-Number'>25</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'bar'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
214:     <span class='def-SymbolStrong def-Symbol'>}</span>
215: 
216:     <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$1</span> <span class='perl-Word def-Keyword'>if</span> <span class='perl-String def-String'>'bar'</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>+</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-Var def-Var'>$TAINT</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
217:     test <span class='perl-Numb def-Number'>26</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
218:     test <span class='perl-Numb def-Number'>27</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'bar'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
219: 
220:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$pi</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>4</span> <span class='perl-Symb def-Symbol'>*</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>atan2</span><span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>,</span><span class='perl-Numb def-Number'>1</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>+</span> <span class='perl-Var def-Var'>$TAINT0</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
221:     test <span class='perl-Numb def-Number'>28</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$pi</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
222: 
223:     <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$pi</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$pi</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-SymbClass def-Var'>\d</span><span class='regexp-MetaSymb def-Symbol'>+</span><span class='regexp-Symbol def-StringContent def-String'>\.</span><span class='regexp-SymbClass def-Var'>\d</span><span class='regexp-MetaSymb def-Symbol'>+</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
224:     test <span class='perl-Numb def-Number'>29</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$pi</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
225:     test <span class='perl-Numb def-Number'>30</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>sprintf</span><span class='def-Symbol'>(</span><span class='perl-String def-String'>"</span><span class='perl-Var2 def-VarStrong def-Var'>%</span><span class='perl-Symb def-Symbol'>.</span><span class='perl-Var2 def-VarStrong def-Var'>5f</span><span class='perl-String def-String'>"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$pi</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'3.14159'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
226: <span class='def-SymbolStrong def-Symbol'>}</span>
227: 
228: <span class='perl-Comment def-Comment def-Syntax'># How about command-line arguments? The problem is that we don't</span>
229: <span class='perl-Comment def-Comment def-Syntax'># always get some, so we'll run another process with some.</span>
230: <span class='def-SymbolStrong def-Symbol'>{</span>
231:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$arg</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"./arg</span><span class='perl-Var def-Var'>$$</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
232:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span> PROG<span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"> </span><span class='perl-Var def-Var'>$arg</span><span class='perl-String def-String'>"</span> <span class='perl-Symb def-Symbol'>or</span> <span class='perl-Word def-Keyword'>die</span> <span class='perl-String def-String'>"Can't create </span><span class='perl-Var def-Var'>$arg</span><span class='perl-String def-String'>: </span><span class='perl-Var def-Var'>$!</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
233:     <span class='perl-Word def-Keyword'>print</span> PROG <span class='perl-ReType perl-Word def-Keyword'>q</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>{</span><span class='perl-String def-String'></span>
234: <span class='perl-String def-String'>    eval { join('', @ARGV), kill 0 };</span>
235: <span class='perl-String def-String'>    exit 0 if $@ =~ /^Insecure dependency/;</span>
236: <span class='perl-String def-String'>    print "# Oops: \$@ was [$@]\n";</span>
237: <span class='perl-String def-String'>    exit 1;</span>
238: <span class='perl-String def-String'>    </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
239:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>close</span> PROG<span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
240:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$Invoke_Perl</span><span class='perl-SystemExec def-Insertion'> "-T" </span><span class='perl-Var def-Var'>$arg</span><span class='perl-SystemExec def-Insertion'> and some suspect arguments</span><span class='perl-String def-String'>`</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
241:     test <span class='perl-Numb def-Number'>31</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>!</span><span class='perl-Var def-Var'>$?</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"Exited with status </span><span class='perl-Var def-Var'>$?</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
242:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span> <span class='perl-Var def-Var'>$arg</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
243: <span class='def-SymbolStrong def-Symbol'>}</span>
244: 
245: <span class='perl-Comment def-Comment def-Syntax'># Reading from a file should be tainted</span>
246: <span class='def-SymbolStrong def-Symbol'>{</span>
247:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$file</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>'./TEST'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
248:     test <span class='perl-Numb def-Number'>32</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span><span class='def-Symbol'>(</span>FILE<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$file</span><span class='def-Symbol'>)</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"Couldn't open '</span><span class='perl-Var def-Var'>$file</span><span class='perl-String def-String'>': </span><span class='perl-Var def-Var'>$!</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
249: 
250:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$block</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
251:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>sysread</span><span class='def-Symbol'>(</span>FILE<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$block</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>100</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
252:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$line</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Stream def-Path def-URI'>&lt;FILE></span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
253:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>close</span> FILE<span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
254:     test <span class='perl-Numb def-Number'>33</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$block</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
255:     test <span class='perl-Numb def-Number'>34</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$line</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
256: <span class='def-SymbolStrong def-Symbol'>}</span>
257: 
258: <span class='perl-Comment def-Comment def-Syntax'># Globs should be forbidden, except under VMS,</span>
259: <span class='perl-Comment def-Comment def-Syntax'>#   which doesn't spawn an external program.</span>
260: <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>1</span>  <span class='perl-Comment def-Comment def-Syntax'># built-in glob</span>
261:     <span class='perl-Symb def-Symbol'>or</span> <span class='perl-Var def-Var'>$Is_VMS</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
262:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>35</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>36</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> <span class='def-SymbolStrong def-Symbol'>}</span>
263: <span class='def-SymbolStrong def-Symbol'>}</span>
264: <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
265:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@globs</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Stream def-Path def-URI'>&lt;</span><span class='regexp-MetaSymb def-Symbol'>*</span><span class='perl-Stream def-Path def-URI'>></span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
266:     test <span class='perl-Numb def-Number'>35</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>@globs</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>0</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
267: 
268:     <span class='perl-Var def-Var'>@globs</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>glob</span> <span class='perl-String def-String'>'*'</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
269:     test <span class='perl-Numb def-Number'>36</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>@globs</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>0</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
270: <span class='def-SymbolStrong def-Symbol'>}</span>
271: 
272: <span class='perl-Comment def-Comment def-Syntax'># Output of commands should be tainted</span>
273: <span class='def-SymbolStrong def-Symbol'>{</span>
274:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> abc</span><span class='perl-String def-String'>`</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
275:     test <span class='perl-Numb def-Number'>37</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
276: <span class='def-SymbolStrong def-Symbol'>}</span>
277: 
278: <span class='perl-Comment def-Comment def-Syntax'># Certain system variables should be tainted</span>
279: <span class='def-SymbolStrong def-Symbol'>{</span>
280:     test <span class='perl-Numb def-Number'>38</span><span class='perl-Symb def-Symbol'>,</span> all_tainted <span class='perl-Var def-Var'>$^X</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$0</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
281: <span class='def-SymbolStrong def-Symbol'>}</span>
282: 
283: <span class='perl-Comment def-Comment def-Syntax'># Results of matching should all be untainted</span>
284: <span class='def-SymbolStrong def-Symbol'>{</span>
285:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"abcdefghi"</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
286:     test <span class='perl-Numb def-Number'>39</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
287: 
288:     <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-String def-String'>def</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
289:     test <span class='perl-Numb def-Number'>40</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> any_tainted <span class='perl-Var def-Var'>$`</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$&amp;</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
290: 
291:     <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
292:     test <span class='perl-Numb def-Number'>41</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> any_tainted <span class='perl-Var def-Var'>$1</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$2</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$3</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$+</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
293: 
294:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@bar</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-MetaSymb def-Symbol'>.</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
295:     test <span class='perl-Numb def-Number'>42</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> any_tainted <span class='perl-Var def-Var'>@bar</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
296: 
297:     test <span class='perl-Numb def-Number'>43</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>    <span class='perl-Comment def-Comment def-Syntax'># $foo should still be tainted!</span>
298:     test <span class='perl-Numb def-Number'>44</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>"abcdefghi"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
299: <span class='def-SymbolStrong def-Symbol'>}</span>
300: 
301: <span class='perl-Comment def-Comment def-Syntax'># Operations which affect files can't use tainted data.</span>
302: <span class='def-SymbolStrong def-Symbol'>{</span>
303:     test <span class='perl-Numb def-Number'>45</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>chmod</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'chmod'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
304:     test <span class='perl-Numb def-Number'>46</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
305: 
306:     <span class='perl-Comment def-Comment def-Syntax'># There is no feature test in $Config{} for truncate,</span>
307:     <span class='perl-Comment def-Comment def-Syntax'>#   so we allow for the possibility that it's missing.</span>
308:     test <span class='perl-Numb def-Number'>47</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>truncate</span> <span class='perl-String def-String'>'NoSuChFiLe'</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT0</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'truncate'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
309:     test <span class='perl-Numb def-Number'>48</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='regexp-Quote regexp-MetaSymb def-Symbol'>(</span><span class='regexp-SpecQuote def-StringEdge def-String'>?</span><span class='regexp-SpecQuote def-StringEdge def-String'>:</span>Insecure dependency<span class='regexp-MetaSymbStrong def-SymbolStrong def-Symbol'>|</span>truncate not implemented<span class='regexp-Quote regexp-MetaSymb def-Symbol'>)</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
310: 
311:     test <span class='perl-Numb def-Number'>49</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>rename</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'rename'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
312:     test <span class='perl-Numb def-Number'>50</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
313: 
314:     test <span class='perl-Numb def-Number'>51</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'unlink'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
315:     test <span class='perl-Numb def-Number'>52</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
316: 
317:     test <span class='perl-Numb def-Number'>53</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>utime</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'utime'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
318:     test <span class='perl-Numb def-Number'>54</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
319: 
320:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_chown</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
321:     test <span class='perl-Numb def-Number'>55</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>chown</span> <span class='perl-Symb def-Symbol'>-</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>-</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'chown'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
322:     test <span class='perl-Numb def-Number'>56</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
323:     <span class='def-SymbolStrong def-Symbol'>}</span>
324:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
325:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>55</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>56</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: chown() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
326:     <span class='def-SymbolStrong def-Symbol'>}</span>
327: 
328:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_link</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
329:     test <span class='perl-Numb def-Number'>57</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>link</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>''</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'link'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
330:     test <span class='perl-Numb def-Number'>58</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
331:     <span class='def-SymbolStrong def-Symbol'>}</span>
332:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
333:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>57</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>58</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: link() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
334:     <span class='def-SymbolStrong def-Symbol'>}</span>
335: 
336:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_symlink</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
337:     test <span class='perl-Numb def-Number'>59</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>symlink</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>''</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'symlink'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
338:     test <span class='perl-Numb def-Number'>60</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
339:     <span class='def-SymbolStrong def-Symbol'>}</span>
340:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
341:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>59</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>60</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: symlink() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
342:     <span class='def-SymbolStrong def-Symbol'>}</span>
343: <span class='def-SymbolStrong def-Symbol'>}</span>
344: 
345: <span class='perl-Comment def-Comment def-Syntax'># Operations which affect directories can't use tainted data.</span>
346: <span class='def-SymbolStrong def-Symbol'>{</span>
347:     test <span class='perl-Numb def-Number'>61</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>mkdir</span> <span class='perl-Var def-Var'>$TAINT0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'mkdir'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
348:     test <span class='perl-Numb def-Number'>62</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
349: 
350:     test <span class='perl-Numb def-Number'>63</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>rmdir</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'rmdir'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
351:     test <span class='perl-Numb def-Number'>64</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
352: 
353:     test <span class='perl-Numb def-Number'>65</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>chdir</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'chdir'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
354:     test <span class='perl-Numb def-Number'>66</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
355: 
356:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_chroot</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
357:     test <span class='perl-Numb def-Number'>67</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>chroot</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'chroot'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
358:     test <span class='perl-Numb def-Number'>68</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
359:     <span class='def-SymbolStrong def-Symbol'>}</span>
360:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
361:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>67</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>68</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: chroot() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
362:     <span class='def-SymbolStrong def-Symbol'>}</span>
363: <span class='def-SymbolStrong def-Symbol'>}</span>
364: 
365: <span class='perl-Comment def-Comment def-Syntax'># Some operations using files can't use tainted data.</span>
366: <span class='def-SymbolStrong def-Symbol'>{</span>
367:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"imaginary library"</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
368:     test <span class='perl-Numb def-Number'>69</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>require</span> <span class='perl-Var def-Var'>$foo</span> } <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'require'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
369:     test <span class='perl-Numb def-Number'>70</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
370: 
371:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$filename</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"./taintB</span><span class='perl-Var def-Var'>$$</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>    <span class='perl-Comment def-Comment def-Syntax'># NB: $filename isn't tainted!</span>
372:     <span class='perl-Word def-Keyword'>END</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span> <span class='perl-Var def-Var'>$filename</span> <span class='perl-Word def-Keyword'>if</span> <span class='perl-Word def-Keyword'>defined</span> <span class='perl-Var def-Var'>$filename</span> <span class='def-SymbolStrong def-Symbol'>}</span>
373:     <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$filename</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
374:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span> <span class='perl-Var def-Var'>$filename</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>    <span class='perl-Comment def-Comment def-Syntax'># in any case</span>
375: 
376:     test <span class='perl-Numb def-Number'>71</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span> FOO<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'open for read'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
377:     test <span class='perl-Numb def-Number'>72</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>        <span class='perl-Comment def-Comment def-Syntax'># NB: This should be allowed</span>
378: 
379:     <span class='perl-Comment def-Comment def-Syntax'># Try first new style but allow also old style.</span>
380:     test <span class='perl-Numb def-Number'>73</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$!</span><span class='def-SymbolStrong def-Symbol'>{</span>ENOENT<span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span>
381:     <span class='perl-Var def-Var'>$!</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>2</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-Comment def-Comment def-Syntax'># File not found</span>
382:     <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Is_Dos</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Var def-Var'>$!</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>22</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span>
383:     <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'mint'</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Var def-Var'>$!</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>33</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
384: 
385:     test <span class='perl-Numb def-Number'>74</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span> FOO<span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"> </span><span class='perl-Var def-Var'>$foo</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'open for write'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
386:     test <span class='perl-Numb def-Number'>75</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
387: <span class='def-SymbolStrong def-Symbol'>}</span>
388: 
389: <span class='perl-Comment def-Comment def-Syntax'># Commands to the system can't use tainted data</span>
390: <span class='def-SymbolStrong def-Symbol'>{</span>
391:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
392: 
393:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$^O</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>'amigaos'</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
394:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>76</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>79</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: open('|') is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
395:     <span class='def-SymbolStrong def-Symbol'>}</span>
396:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
397:     test <span class='perl-Numb def-Number'>76</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span> FOO<span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"| x</span><span class='perl-Var def-Var'>$foo</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'popen to'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
398:     test <span class='perl-Numb def-Number'>77</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
399: 
400:     test <span class='perl-Numb def-Number'>78</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span> FOO<span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"x</span><span class='perl-Var def-Var'>$foo</span><span class='perl-String def-String'> |"</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'popen from'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
401:     test <span class='perl-Numb def-Number'>79</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
402:     <span class='def-SymbolStrong def-Symbol'>}</span>
403: 
404:     test <span class='perl-Numb def-Number'>80</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>exec</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'exec'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
405:     test <span class='perl-Numb def-Number'>81</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
406: 
407:     test <span class='perl-Numb def-Number'>82</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>system</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'system'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
408:     test <span class='perl-Numb def-Number'>83</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
409: 
410:     <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"*"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
411:     taint_these <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
412: 
413:     test <span class='perl-Numb def-Number'>84</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>`</span><span class='perl-Var def-Var'>$echo</span><span class='perl-SystemExec def-Insertion'> </span><span class='def-NumberDec def-Number'>1</span><span class='perl-Var def-Var'>$foo</span><span class='perl-String def-String'>`</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'backticks'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
414:     test <span class='perl-Numb def-Number'>85</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
415: 
416:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Is_VMS</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Comment def-Comment def-Syntax'># wildcard expansion doesn't invoke shell, so is safe</span>
417:     test <span class='perl-Numb def-Number'>86</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>join</span><span class='def-Symbol'>(</span><span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>glob</span> <span class='perl-Var def-Var'>$foo</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>ne</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'globbing'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
418:     test <span class='perl-Numb def-Number'>87</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
419:     <span class='def-SymbolStrong def-Symbol'>}</span>
420:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
421:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>86</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>87</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: this is not VMS</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> <span class='def-SymbolStrong def-Symbol'>}</span>
422:     <span class='def-SymbolStrong def-Symbol'>}</span>
423: <span class='def-SymbolStrong def-Symbol'>}</span>
424: 
425: <span class='perl-Comment def-Comment def-Syntax'># Operations which affect processes can't use tainted data.</span>
426: <span class='def-SymbolStrong def-Symbol'>{</span>
427:     test <span class='perl-Numb def-Number'>88</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>kill</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'kill'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
428:     test <span class='perl-Numb def-Number'>89</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
429: 
430:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_setpgrp</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
431:     test <span class='perl-Numb def-Number'>90</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>setpgrp</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'setpgrp'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
432:     test <span class='perl-Numb def-Number'>91</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
433:     <span class='def-SymbolStrong def-Symbol'>}</span>
434:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
435:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>90</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>91</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: setpgrp() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
436:     <span class='def-SymbolStrong def-Symbol'>}</span>
437: 
438:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_setprior</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
439:     test <span class='perl-Numb def-Number'>92</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>setpriority</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'setpriority'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
440:     test <span class='perl-Numb def-Number'>93</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
441:     <span class='def-SymbolStrong def-Symbol'>}</span>
442:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
443:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>92</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>93</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: setpriority() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
444:     <span class='def-SymbolStrong def-Symbol'>}</span>
445: <span class='def-SymbolStrong def-Symbol'>}</span>
446: 
447: <span class='perl-Comment def-Comment def-Syntax'># Some miscellaneous operations can't use tainted data.</span>
448: <span class='def-SymbolStrong def-Symbol'>{</span>
449:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_syscall</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
450:     test <span class='perl-Numb def-Number'>94</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>syscall</span> <span class='perl-Var def-Var'>$TAINT</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'syscall'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
451:     test <span class='perl-Numb def-Number'>95</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
452:     <span class='def-SymbolStrong def-Symbol'>}</span>
453:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
454:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>94</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>95</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: syscall() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
455:     <span class='def-SymbolStrong def-Symbol'>}</span>
456: 
457:     <span class='def-SymbolStrong def-Symbol'>{</span>
458:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"x"</span> <span class='perl-Symb def-Symbol'>x</span> <span class='perl-Numb def-Number'>979</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
459:     taint_these <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
460:     <span class='perl-Word def-Keyword'>local</span> <span class='perl-Var def-Var'>*FOO</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
461:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$temp</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"./taintC</span><span class='perl-Var def-Var'>$$</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
462:     <span class='perl-Word def-Keyword'>END</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span> <span class='perl-Var def-Var'>$temp</span> <span class='def-SymbolStrong def-Symbol'>}</span>
463:     test <span class='perl-Numb def-Number'>96</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>open</span><span class='def-Symbol'>(</span>FOO<span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"> </span><span class='perl-Var def-Var'>$temp</span><span class='perl-String def-String'>"</span><span class='def-Symbol'>)</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"Couldn't open </span><span class='perl-Var def-Var'>$temp</span><span class='perl-String def-String'> for write: </span><span class='perl-Var def-Var'>$!</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
464: 
465:     test <span class='perl-Numb def-Number'>97</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>ioctl</span> FOO<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'ioctl'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
466:     test <span class='perl-Numb def-Number'>98</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
467: 
468:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_fcntl</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
469:         test <span class='perl-Numb def-Number'>99</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>fcntl</span> FOO<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$foo</span> <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-String def-String'>''</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>'fcntl'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
470:         test <span class='perl-Numb def-Number'>100</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span><span class='perl-String def-String'> </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='regexp-MetaSymb def-Symbol'>^</span><span class='perl-String def-String'>Insecure dependency</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$@</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
471:     <span class='def-SymbolStrong def-Symbol'>}</span>
472:     <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
473:         <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>99</span><span class='perl-Symb def-Symbol'>..</span><span class='perl-Numb def-Number'>100</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: fcntl() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
474:     <span class='def-SymbolStrong def-Symbol'>}</span>
475: 
476:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>close</span> FOO<span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
477:     <span class='def-SymbolStrong def-Symbol'>}</span>
478: <span class='def-SymbolStrong def-Symbol'>}</span>
479: 
480: <span class='perl-Comment def-Comment def-Syntax'># Some tests involving references</span>
481: <span class='def-SymbolStrong def-Symbol'>{</span>
482:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>'abc'</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
483:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$fooref</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Symb def-Symbol'>\</span><span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
484:     test <span class='perl-Numb def-Number'>101</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$fooref</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
485:     test <span class='perl-Numb def-Number'>102</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$$fooref</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
486:     test <span class='perl-Numb def-Number'>103</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
487: <span class='def-SymbolStrong def-Symbol'>}</span>
488: 
489: <span class='perl-Comment def-Comment def-Syntax'># Some tests involving assignment</span>
490: <span class='def-SymbolStrong def-Symbol'>{</span>
491:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT0</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
492:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
493:     test <span class='perl-Numb def-Number'>104</span><span class='perl-Symb def-Symbol'>,</span> all_tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$bar</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
494:     test <span class='perl-Numb def-Number'>105</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$bar</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
495:     test <span class='perl-Numb def-Number'>106</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$bar</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
496:     test <span class='perl-Numb def-Number'>107</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>+</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$bar</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
497:     test <span class='perl-Numb def-Number'>108</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>-</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$bar</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
498:     test <span class='perl-Numb def-Number'>109</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>*</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$bar</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
499:     test <span class='perl-Numb def-Number'>110</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span><span class='perl-Symb def-Symbol'>+</span><span class='perl-Symb def-Symbol'>+</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
500:     test <span class='perl-Numb def-Number'>111</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>/</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$bar</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
501:     test <span class='perl-Numb def-Number'>112</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>+</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
502:     test <span class='perl-Numb def-Number'>113</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>-</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>2</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
503:     test <span class='perl-Numb def-Number'>114</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>*</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Symb def-Symbol'>-</span><span class='perl-Numb def-Number'>1</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
504:     test <span class='perl-Numb def-Number'>115</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>/</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>1</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
505:     test <span class='perl-Numb def-Number'>116</span><span class='perl-Symb def-Symbol'>,</span> tainted<span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$bar</span><span class='perl-Symb def-Symbol'>-</span><span class='perl-Symb def-Symbol'>-</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
506:     test <span class='perl-Numb def-Number'>117</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$bar</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>0</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
507: <span class='def-SymbolStrong def-Symbol'>}</span>
508: 
509: <span class='perl-Comment def-Comment def-Syntax'># Test assignment and return of lists</span>
510: <span class='def-SymbolStrong def-Symbol'>{</span>
511:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@foo</span> <span class='perl-Symb def-Symbol'>=</span> <span class='def-Symbol'>(</span><span class='perl-String def-String'>"A"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"tainted"</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"B"</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
512:     test <span class='perl-Numb def-Number'>118</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
513:     test <span class='perl-Numb def-Number'>119</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
514:     test <span class='perl-Numb def-Number'>120</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$foo</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
515:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@bar</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>@foo</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
516:     test <span class='perl-Numb def-Number'>121</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$bar</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
517:     test <span class='perl-Numb def-Number'>122</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$bar</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
518:     test <span class='perl-Numb def-Number'>123</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$bar</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
519:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@baz</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>"A"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"tainted"</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"B"</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
520:     test <span class='perl-Numb def-Number'>124</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$baz</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
521:     test <span class='perl-Numb def-Number'>125</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$baz</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
522:     test <span class='perl-Numb def-Number'>126</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$baz</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
523:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@plugh</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>eval</span> <span class='perl-ReType perl-Word def-Keyword'>q</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>[</span><span class='perl-String def-String'> "A", "tainted" . $TAINT, "B" </span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
524:     test <span class='perl-Numb def-Number'>127</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$plugh</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
525:     test <span class='perl-Numb def-Number'>128</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$plugh</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
526:     test <span class='perl-Numb def-Number'>129</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$plugh</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
527:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$nautilus</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>sub</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-String def-String'>"A"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"tainted"</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"B"</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
528:     test <span class='perl-Numb def-Number'>130</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='def-Symbol'>(</span><span class='def-Symbol'>(</span><span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$nautilus</span><span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>]</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
529:     test <span class='perl-Numb def-Number'>131</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='def-Symbol'>(</span><span class='def-Symbol'>(</span><span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$nautilus</span><span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='def-Symbol'>]</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
530:     test <span class='perl-Numb def-Number'>132</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='def-Symbol'>(</span><span class='def-Symbol'>(</span><span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$nautilus</span><span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='def-Symbol'>]</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
531:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@xyzzy</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$nautilus</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
532:     test <span class='perl-Numb def-Number'>133</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$xyzzy</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
533:     test <span class='perl-Numb def-Number'>134</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$xyzzy</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
534:     test <span class='perl-Numb def-Number'>135</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$xyzzy</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
535:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$red_october</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>sub</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>return</span> <span class='perl-String def-String'>"A"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"tainted"</span> <span class='perl-Symb def-Symbol'>.</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"B"</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
536:     test <span class='perl-Numb def-Number'>136</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='def-Symbol'>(</span><span class='def-Symbol'>(</span><span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$red_october</span><span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>]</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
537:     test <span class='perl-Numb def-Number'>137</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='def-Symbol'>(</span><span class='def-Symbol'>(</span><span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$red_october</span><span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='def-Symbol'>]</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
538:     test <span class='perl-Numb def-Number'>138</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='def-Symbol'>(</span><span class='def-Symbol'>(</span><span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$red_october</span><span class='def-Symbol'>)</span><span class='def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='def-Symbol'>]</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
539:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@corge</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Var def-Var'>$red_october</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
540:     test <span class='perl-Numb def-Number'>139</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$corge</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
541:     test <span class='perl-Numb def-Number'>140</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$corge</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
542:     test <span class='perl-Numb def-Number'>141</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$corge</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>]</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
543: <span class='def-SymbolStrong def-Symbol'>}</span>
544: 
545: <span class='perl-Comment def-Comment def-Syntax'># Test for system/library calls returning string data of dubious origin.</span>
546: <span class='def-SymbolStrong def-Symbol'>{</span>
547:     <span class='perl-Comment def-Comment def-Syntax'># No reliable %Config check for getpw*</span>
548:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Word def-Keyword'>eval</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>setpwent</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>getpwent</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> <span class='perl-Numb def-Number'>1</span> <span class='def-SymbolStrong def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
549:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>setpwent</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
550:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>@getpwent</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>getpwent</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
551:     <span class='perl-Word def-Keyword'>die</span> <span class='perl-String def-String'>"getpwent: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='perl-Word def-Keyword'>unless</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>@getpwent</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
552:     test <span class='perl-Numb def-Number'>142</span><span class='perl-Symb def-Symbol'>,</span><span class='def-Symbol'>(</span>    <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>]</span>
553:               <span class='perl-Symb def-Symbol'>and</span>     tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>1</span><span class='perl-Symb def-Symbol'>]</span>
554:               <span class='perl-Symb def-Symbol'>and</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>2</span><span class='perl-Symb def-Symbol'>]</span>
555:               <span class='perl-Symb def-Symbol'>and</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>3</span><span class='perl-Symb def-Symbol'>]</span>
556:               <span class='perl-Symb def-Symbol'>and</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>4</span><span class='perl-Symb def-Symbol'>]</span>
557:               <span class='perl-Symb def-Symbol'>and</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>5</span><span class='perl-Symb def-Symbol'>]</span>
558:               <span class='perl-Symb def-Symbol'>and</span>     tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>6</span><span class='perl-Symb def-Symbol'>]</span>        <span class='perl-Comment def-Comment def-Syntax'># ge?cos</span>
559:               <span class='perl-Symb def-Symbol'>and</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>7</span><span class='perl-Symb def-Symbol'>]</span>
560:           <span class='perl-Symb def-Symbol'>and</span>     tainted <span class='perl-Var def-Var'>$getpwent</span><span class='perl-Symb def-Symbol'>[</span><span class='perl-Numb def-Number'>8</span><span class='perl-Symb def-Symbol'>]</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>    <span class='perl-Comment def-Comment def-Syntax'># shell</span>
561:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>endpwent</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
562:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
563:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>142</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: getpwent() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
564:     <span class='def-SymbolStrong def-Symbol'>}</span>
565: 
566:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_readdir</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Comment def-Comment def-Syntax'># pretty hard to imagine not</span>
567:     <span class='perl-Word def-Keyword'>local</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>*D</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
568:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>opendir</span><span class='def-Symbol'>(</span>D<span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"op"</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>or</span> <span class='perl-Word def-Keyword'>die</span> <span class='perl-String def-String'>"opendir: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
569:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$readdir</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>readdir</span><span class='def-Symbol'>(</span>D<span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
570:     test <span class='perl-Numb def-Number'>143</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$readdir</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
571:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>closedir</span><span class='def-Symbol'>(</span>OP<span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
572:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
573:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>143</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: readdir() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span> <span class='def-SymbolStrong def-Symbol'>}</span>
574:     <span class='def-SymbolStrong def-Symbol'>}</span>
575: 
576:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_readlink</span><span class='perl-Symb def-Symbol'>}</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_symlink</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
577:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$symlink</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"sl</span><span class='perl-Var def-Var'>$$</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
578:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$symlink</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
579:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>symlink</span><span class='def-Symbol'>(</span><span class='perl-String def-String'>"/something/naughty"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$symlink</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>or</span> <span class='perl-Word def-Keyword'>die</span> <span class='perl-String def-String'>"symlink: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
580:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$readlink</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>readlink</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$symlink</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
581:     test <span class='perl-Numb def-Number'>144</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$readlink</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
582:     <span class='perl-WordFun def-FunctionKeyword def-Keyword'>unlink</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$symlink</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
583:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
584:     <span class='perl-Word def-Keyword'>for</span> <span class='def-Symbol'>(</span><span class='perl-Numb def-Number'>144</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span> <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='perl-Var def-Var'>$_</span><span class='perl-String def-String'> # Skipped: readlink() or symlink() is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span> <span class='def-SymbolStrong def-Symbol'>}</span>
585:     <span class='def-SymbolStrong def-Symbol'>}</span>
586: <span class='def-SymbolStrong def-Symbol'>}</span>
587: 
588: <span class='perl-Comment def-Comment def-Syntax'># test bitwise ops (regression </span><span class='def-TODO def-Error'>bug)</span>
589: <span class='def-SymbolStrong def-Symbol'>{</span>
590:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$why</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"y"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
591:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$j</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"x"</span> <span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$why</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
592:     test <span class='perl-Numb def-Number'>145</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Symb def-Symbol'>not</span> tainted <span class='perl-Var def-Var'>$j</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
593:     <span class='perl-Var def-Var'>$why</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>.</span><span class='perl-String def-String'>"y"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
594:     <span class='perl-Var def-Var'>$j</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"x"</span> <span class='perl-Symb def-Symbol'>|</span> <span class='perl-Var def-Var'>$why</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
595:     test <span class='perl-Numb def-Number'>146</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$j</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
596: <span class='def-SymbolStrong def-Symbol'>}</span>
597: 
598: <span class='perl-Comment def-Comment def-Syntax'># test target of substitution (regression </span><span class='def-TODO def-Error'>bug)</span>
599: <span class='def-SymbolStrong def-Symbol'>{</span>
600:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$why</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$TAINT</span><span class='perl-Symb def-Symbol'>.</span><span class='perl-String def-String'>"y"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
601:     <span class='perl-Var def-Var'>$why</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span> <span class='perl-ReType perl-Word def-Keyword'>s</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-String def-String'>y</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-String def-String'>z</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
602:     test <span class='perl-Numb def-Number'>147</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$why</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
603: 
604:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$z</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"[z]"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
605:     <span class='perl-Var def-Var'>$why</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span> <span class='perl-ReType perl-Word def-Keyword'>s</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-Var def-Var'>$z</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-String def-String'>zee</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
606:     test <span class='perl-Numb def-Number'>148</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$why</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
607: 
608:     <span class='perl-Var def-Var'>$why</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>~</span> <span class='perl-ReType perl-Word def-Keyword'>s</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-String def-String'>e</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-String def-String'>'-'.</span><span class='perl-Var def-Var'>$$</span><span class='perl-StringEdge regexp-SpecQuote def-StringEdge def-String'>/</span><span class='perl-ReModif regexp-SpecArea def-Keyword'>ge</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
609:     test <span class='perl-Numb def-Number'>149</span><span class='perl-Symb def-Symbol'>,</span>     tainted <span class='perl-Var def-Var'>$why</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
610: <span class='def-SymbolStrong def-Symbol'>}</span>
611: 
612: <span class='perl-Comment def-Comment def-Syntax'># test shmread</span>
613: <span class='def-SymbolStrong def-Symbol'>{</span>
614:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_shm</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
615:     <span class='perl-Word def-Keyword'>no</span> <span class='perl-packages-pragmas perl-Word def-Keyword'>strict</span> <span class='perl-String def-String'>'subs'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
616:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$sent</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"foobar"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
617:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$rcvd</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
618:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$size</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>2000</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
619:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$id</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>shmget</span><span class='def-Symbol'>(</span>IPC_PRIVATE<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$size</span><span class='perl-Symb def-Symbol'>,</span> S_IRWXU<span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span>
620:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# shmget failed: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
621:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Word def-Keyword'>defined</span> <span class='perl-Var def-Var'>$id</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
622:         <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-WordFun def-FunctionKeyword def-Keyword'>shmwrite</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$id</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$sent</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>60</span><span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
623:         <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-WordFun def-FunctionKeyword def-Keyword'>shmread</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$id</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$rcvd</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>60</span><span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
624:             <span class='perl-WordFun def-FunctionKeyword def-Keyword'>substr</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$rcvd</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>index</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$rcvd</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-String def-String'>"\</span><span class='def-NumberDec def-Number'>0</span><span class='perl-String def-String'>"</span><span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>''</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
625:         <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
626:             <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# shmread failed: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
627:         <span class='def-SymbolStrong def-Symbol'>}</span>
628:         <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
629:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# shmwrite failed: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
630:         <span class='def-SymbolStrong def-Symbol'>}</span>
631:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>shmctl</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$id</span><span class='perl-Symb def-Symbol'>,</span> IPC_RMID<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# shmctl failed: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
632:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
633:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# shmget failed: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
634:     <span class='def-SymbolStrong def-Symbol'>}</span>
635: 
636:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$rcvd</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-Var def-Var'>$sent</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
637:         test <span class='perl-Numb def-Number'>150</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$rcvd</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
638:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
639:         <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='def-NumberDec def-Number'>150</span><span class='perl-String def-String'> # Skipped: SysV shared memory operation failed</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
640:     <span class='def-SymbolStrong def-Symbol'>}</span>
641:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
642:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='def-NumberDec def-Number'>150</span><span class='perl-String def-String'> # Skipped: SysV shared memory is not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
643:     <span class='def-SymbolStrong def-Symbol'>}</span>
644: <span class='def-SymbolStrong def-Symbol'>}</span>
645: 
646: <span class='perl-Comment def-Comment def-Syntax'># test msgrcv</span>
647: <span class='def-SymbolStrong def-Symbol'>{</span>
648:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$Config</span><span class='perl-Symb def-Symbol'>{</span><span class='perl-Var def-Var'>d_msg</span><span class='perl-Symb def-Symbol'>}</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
649:     <span class='perl-Word def-Keyword'>no</span> <span class='perl-packages-pragmas perl-Word def-Keyword'>strict</span> <span class='perl-String def-String'>'subs'</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
650:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$id</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>msgget</span><span class='def-Symbol'>(</span>IPC_PRIVATE<span class='perl-Symb def-Symbol'>,</span> IPC_CREAT <span class='perl-Symb def-Symbol'>|</span> S_IRWXU<span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
651: 
652:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$sent</span>      <span class='perl-Symb def-Symbol'>=</span> <span class='perl-String def-String'>"message"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
653:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$type_sent</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Numb def-Number'>1234</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
654:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$rcvd</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
655:     <span class='perl-Word def-Keyword'>my</span> <span class='perl-Var def-Var'>$type_rcvd</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
656: 
657:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Word def-Keyword'>defined</span> <span class='perl-Var def-Var'>$id</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
658:         <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-WordFun def-FunctionKeyword def-Keyword'>msgsnd</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$id</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Word def-Keyword'>pack</span><span class='def-Symbol'>(</span><span class='perl-String def-String'>"l! a*"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$type_sent</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$sent</span><span class='def-Symbol'>)</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
659:         <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-WordFun def-FunctionKeyword def-Keyword'>msgrcv</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$id</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$rcvd</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>60</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
660:             <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$type_rcvd</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$rcvd</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>=</span> <span class='perl-Word def-Keyword'>unpack</span><span class='def-Symbol'>(</span><span class='perl-String def-String'>"l! a*"</span><span class='perl-Symb def-Symbol'>,</span> <span class='perl-Var def-Var'>$rcvd</span><span class='def-Symbol'>)</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
661:         <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
662:             <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# msgrcv failed</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
663:         <span class='def-SymbolStrong def-Symbol'>}</span>
664:         <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
665:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# msgsnd failed</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
666:         <span class='def-SymbolStrong def-Symbol'>}</span>
667:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>msgctl</span><span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$id</span><span class='perl-Symb def-Symbol'>,</span> IPC_RMID<span class='perl-Symb def-Symbol'>,</span> <span class='perl-Numb def-Number'>0</span><span class='def-Symbol'>)</span> <span class='perl-Symb def-Symbol'>|</span><span class='perl-Symb def-Symbol'>|</span> <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# msgctl failed: </span><span class='perl-Var def-Var'>$!</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
668:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
669:         <span class='perl-WordFun def-FunctionKeyword def-Keyword'>warn</span> <span class='perl-String def-String'>"# msgget failed</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
670:     <span class='def-SymbolStrong def-Symbol'>}</span>
671: 
672:     <span class='perl-Word def-Keyword'>if</span> <span class='def-Symbol'>(</span><span class='perl-Var def-Var'>$rcvd</span> <span class='perl-Symb def-Symbol'>eq</span> <span class='perl-Var def-Var'>$sent</span> <span class='perl-Symb def-Symbol'>&amp;</span><span class='perl-Symb def-Symbol'>&amp;</span> <span class='perl-Var def-Var'>$type_sent</span> <span class='perl-Symb def-Symbol'>=</span><span class='perl-Symb def-Symbol'>=</span> <span class='perl-Var def-Var'>$type_rcvd</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
673:         test <span class='perl-Numb def-Number'>151</span><span class='perl-Symb def-Symbol'>,</span> tainted <span class='perl-Var def-Var'>$rcvd</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
674:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
675:         <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='def-NumberDec def-Number'>151</span><span class='perl-String def-String'> # Skipped: SysV message queue operation failed</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
676:     <span class='def-SymbolStrong def-Symbol'>}</span>
677:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='perl-Word def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
678:     <span class='perl-Word def-Keyword'>print</span> <span class='perl-String def-String'>"ok </span><span class='def-NumberDec def-Number'>151</span><span class='perl-String def-String'> # Skipped: SysV message queues are not available</span><span class='regexp-Symbol def-StringContent def-String'>\n</span><span class='perl-String def-String'>"</span><span class='perl-MainSymb def-SymbolStrong def-Symbol'>;</span>
679:     <span class='def-SymbolStrong def-Symbol'>}</span>
680: <span class='def-SymbolStrong def-Symbol'>}</span>
681: 
682: 
