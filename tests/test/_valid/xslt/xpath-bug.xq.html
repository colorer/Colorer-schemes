 0: <span class='xquery-directive xml-PI-name xml-decl-name def-Directive'>xquery</span><span class='xquery-keyword def-Keyword'> version</span> <span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span><span class='xpath2-literal xpath-literal def-String'>1.0</span><span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span> <span class='xquery-keyword def-Keyword'>encoding</span> <span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span><span class='xpath2-literal xpath-literal def-String'>windows-1251</span><span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span><span class='xquery-sep def-SymbolStrong def-Symbol'>;</span>
 1: 
 2: <span class='xquery-directive xml-PI-name xml-decl-name def-Directive'>declare</span><span class='xquery-keyword def-Keyword'> namespace</span> <span class='xquery-directive-attr xml-PI-content xml-decl-content def-DirectiveContent def-Directive'>def</span> <span class='xquery-directive-eq xml-Attribute-eq def-Symbol'>=</span> <span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span><span class='uri-scheme uri-nsprefix def-Prefix'>colorer</span><span class='uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='uri-delit def-Keyword'>//</span><span class='uri-authority def-URL def-URI'>hrc</span><span class='uri-path def-Path def-URI'>/lib/default.hrc</span><span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span><span class='xquery-sep def-SymbolStrong def-Symbol'>;</span>
 3: 
 4: <span class='xquery-directive xml-PI-name xml-decl-name def-Directive'>declare</span><span class='xquery-keyword def-Keyword'> variable</span> 
 5:     <span class='def-Comment def-Syntax'>(: типы от потолка (: из hrc :) берем :)</span>
 6:     <span class='xpath2-var xpath-var def-Var'>$</span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>def</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-var xpath-var def-Var'>test1</span> <span class='xpath2-expr-key def-Keyword'>as</span> <span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>def</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-seq-name xpath2-qn-name xmlschema-Scheme-name xml-QName-name def-String'>empty</span> <span class='xquery-sep-eq xquery-directive-eq xml-Attribute-eq def-Symbol'>:=</span> <span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>ccc</span><span class='xquery-sep def-SymbolStrong def-Symbol'>;</span> 
 7: <span class='xquery-directive xml-PI-name xml-decl-name def-Directive'>declare</span><span class='xquery-keyword def-Keyword'> variable</span> <span class='xpath2-var xpath-var def-Var'>$</span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>def</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-var xpath-var def-Var'>test2</span> <span class='xquery-sep-eq xquery-directive-eq xml-Attribute-eq def-Symbol'>:=</span> <span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-seq-name xpath2-qn-name xmlschema-Scheme-name xml-QName-name def-String'>ccc </span><span class='xpath2-expr-op xpath-expr-op def-Operator def-Symbol'>+</span> <span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>ccc</span><span class='xquery-sep def-SymbolStrong def-Symbol'>;</span> <span class='def-Comment def-Syntax'>(: отвалилось... :)</span>
 8: <span class='xquery-directive xml-PI-name xml-decl-name def-Directive'>declare</span><span class='xquery-keyword def-Keyword'> variable</span> <span class='xpath2-var xpath-var def-Var'>$</span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>def</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-var xpath-var def-Var'>test3</span><span class='xquery-sep-eq xquery-directive-eq xml-Attribute-eq def-Symbol'>:=</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span><span class='xquery-sep def-SymbolStrong def-Symbol'>;</span>
 9: <span class='xquery-directive xml-PI-name xml-decl-name def-Directive'>declare</span><span class='xquery-keyword def-Keyword'> variable</span> <span class='xpath2-var xpath-var def-Var'>$</span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>test4</span><span class='xquery-sep-eq xquery-directive-eq xml-Attribute-eq def-Symbol'>:=</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span><span class='xquery-sep def-SymbolStrong def-Symbol'>;</span> <span class='def-Comment def-Syntax'>(: глюка :)</span>
10: 
11: <span class='xquery-directive xml-PI-name xml-decl-name def-Directive'>declare</span><span class='xquery-keyword def-Keyword'> function</span><span class='xpath2-func-quote xpath-func-quote def-Symbol'> </span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>def</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-qn-name xmlschema-Scheme-name xml-QName-name def-String'>foo</span><span class='xpath2-func-quote xpath-func-quote def-Symbol'> (</span><span class='xpath2-var xpath-var def-Var'>$bar</span> <span class='xpath2-expr-key def-Keyword'>as</span> <span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>xs</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-seq-name xpath2-qn-name xmlschema-Scheme-name xml-QName-name def-String'>string</span><span class='xpath2-func-quote xpath-func-quote def-Symbol'>)</span> <span class='xpath2-expr-key def-Keyword'>as</span> <span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>def</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-seq-name xpath2-qn-name xmlschema-Scheme-name xml-QName-name def-String'>Text</span>
12: <span class='xquery-sep def-SymbolStrong def-Symbol'>{</span>
13:     <span class='xpath2-expr-key def-Keyword'>let</span> <span class='xpath2-var xpath-var def-Var'>$</span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>xx</span><span class='xquery-sep-eq xquery-directive-eq xml-Attribute-eq def-Symbol'>:=</span> <span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span><span class='xpath2-expr-op xpath-expr-op def-Operator def-Symbol'>,</span> <span class='def-Comment def-Syntax'>(: глюка :)</span>
14:     <span class='xpath2-expr-key def-Keyword'>let</span> <span class='xpath2-var xpath-var def-Var'>$aa</span> <span class='xpath2-expr-key def-Keyword'>as</span> <span class='xpath2-node-type xpath-node-type def-TypeKeyword def-Keyword'>empty</span><span class='xpath2-node-type-abbr xpath-node-type-abbr def-Symbol'>()</span><span class='xpath2-expr-op xpath-expr-op def-Operator def-Symbol'>?</span> <span class='xquery-sep-eq xquery-directive-eq xml-Attribute-eq def-Symbol'>:=</span> <span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span><span class='xpath2-expr-op xpath-expr-op def-Operator def-Symbol'>,</span>
15:         <span class='xpath2-var xpath-var def-Var'>$bb</span> <span class='xquery-sep-eq xquery-directive-eq xml-Attribute-eq def-Symbol'>:=</span> <span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span><span class='xpath2-expr-op xpath-expr-op def-Operator def-Symbol'>,</span>
16:         <span class='xpath2-var xpath-var def-Var'>$</span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>cc</span><span class='def-Error'>:</span><span class='def-Error'>=</span> <span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>aaa</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bbb</span> <span class='def-Comment def-Syntax'>(: совсем плохо... :)</span>
17:     
18:     <span class='xml-element-start-lt def-OpenTag def-Tag'>&lt;</span><span class='xml-element-start-name def-Tag'>aaa</span><span class='xml-element-start-gt def-OpenTag def-Tag'>></span><span class='xquery-xml def-Text'></span>
19:     <span class='xpath2-embedded-quote xpath-embedded-quote def-EmbeddedTag def-Tag'>{</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'></span>
20: <span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'>        </span><span class='xpath2-expr-key def-Keyword'>for</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'> </span><span class='xpath2-var xpath-var def-Var'>$aa</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'> </span><span class='xpath2-expr-key def-Keyword'>in</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'> </span><span class='xpath2-var xpath-var def-Var'>$n</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'> </span><span class='xpath2-expr-key def-Keyword'>return</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'> </span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>xxx</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'> </span><span class='def-Comment def-Syntax'>(: и так далее... </span>
21: <span class='def-Comment def-Syntax'>все возможности будем проверять как-нибудь в другой раз... :)</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'> </span>
22: <span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'>    </span><span class='xpath2-embedded-quote xpath-embedded-quote def-EmbeddedTag def-Tag'>}</span>
23:     <span class='xml-element-end-lt def-CloseTag def-Tag'>&lt;/</span><span class='xml-element-end-name def-Tag'>aaa</span><span class='xml-element-end-gt def-CloseTag def-Tag'>></span>
24: <span class='xquery-sep def-SymbolStrong def-Symbol'>}</span><span class='xquery-sep def-SymbolStrong def-Symbol'>;</span>
25: 
26: <span class='xml-element-start-lt def-OpenTag def-Tag'>&lt;</span><span class='xml-element-start-name def-Tag'>foo</span><span class='xml-element-start-gt def-OpenTag def-Tag'>></span><span class='xquery-xml def-Text'></span>
27: <span class='xpath2-embedded-quote xpath-embedded-quote def-EmbeddedTag def-Tag'>{</span><span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'></span>
28: <span class='xpath2-embedded-content xpath-embedded-content def-InsertionEmbed def-Insertion'>    </span><span class='xpath2-qn-nsprefix xpath2-node-nsprefix xpath-node-nsprefix uri-nsprefix def-Prefix'>def</span><span class='xpath2-qn-nscolon xpath2-node-nscolon xpath-node-nscolon uri-nscolon def-SymbolStrong def-Symbol'>:</span><span class='xpath2-qn-name xmlschema-Scheme-name xml-QName-name def-String'>foo</span><span class='xpath2-func-quote xpath-func-quote def-Symbol'>(</span><span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span><span class='xml-CharRef def-Parameter'>&amp;</span><span class='xml-CharRef def-Parameter'>lt</span><span class='xml-CharRef def-Parameter'>;</span><span class='xpath2-literal xpath-literal def-String'>фигня</span><span class='xml-CharRef def-Parameter'>&amp;</span><span class='xml-CharRef def-Parameter'>gt</span><span class='xml-CharRef def-Parameter'>;</span><span class='xpath2-literal-quote xpath-literal-quote def-StringEdge def-String'>"</span><span class='xpath2-func-quote xpath-func-quote def-Symbol'>)</span><span class='xpath2-path-separator xpath-path-separator uri-delit def-Keyword'>/</span><span class='xpath2-node-name xpath-node-name uri-path def-Path def-URI'>bar</span>
29: <span class='xpath2-embedded-quote xpath-embedded-quote def-EmbeddedTag def-Tag'>}</span>
30: <span class='xml-element-end-lt def-CloseTag def-Tag'>&lt;/</span><span class='xml-element-end-name def-Tag'>foo</span><span class='xml-element-end-gt def-CloseTag def-Tag'>></span>
31: 
