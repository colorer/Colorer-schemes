  0: <span class='def-CommentDoc def-Comment def-Syntax'>/**</span>
  1: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> Let's Walk Through a Maze.</span>
  2: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'></span>
  3: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> Imagine there is a maze whose walls are the big 'O' letters.</span>
  4: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> Now</span><span class='def-CommentContent def-Comment def-Syntax'>,</span><span class='def-CommentDoc def-Comment def-Syntax'> I stand where a big 'I' stands and some cool prize lies</span>
  5: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> somewhere marked with a '$' sign. Like this</span><span class='def-CommentContent def-Comment def-Syntax'>:</span><span class='def-CommentDoc def-Comment def-Syntax'></span>
  6: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'></span>
  7: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    OOOOOOOOOOOOOOOOO</span>
  8: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O               O</span>
  9: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O$  O           O</span>
 10: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    OOOOO           O</span>
 11: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O               O</span>
 12: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O  OOOOOOOOOOOOOO</span>
 13: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O           O I O</span>
 14: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O               O</span>
 15: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    OOOOOOOOOOOOOOOOO</span>
 16: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'></span>
 17: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> I want to get the prize</span><span class='def-CommentContent def-Comment def-Syntax'>,</span><span class='def-CommentDoc def-Comment def-Syntax'> and this program helps me do so as soon</span>
 18: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> as I possibly can by finding a shortest path through the maze.</span>
 19: <span class='def-CommentDoc def-Comment def-Syntax'> */</span>
 20: <span class='def-Keyword'>package</span> maze
 21: 
 22: <span class='def-Keyword'>import</span> <span class='def-VarStrong def-Var'>java.util.Collections.*</span>
 23: <span class='def-Keyword'>import</span> <span class='def-VarStrong def-Var'>java.util.*</span>
 24: 
 25: <span class='def-CommentDoc def-Comment def-Syntax'>/**</span>
 26: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> This function looks for a path from max</span><span class='def-Number'>.</span><span class='def-CommentDoc def-Comment def-Syntax'>start to maze</span><span class='def-Number'>.</span><span class='def-CommentDoc def-Comment def-Syntax'>end through</span>
 27: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> free space (a path does not go through walls). One can move only</span>
 28: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> straightly up</span><span class='def-CommentContent def-Comment def-Syntax'>,</span><span class='def-CommentDoc def-Comment def-Syntax'> down</span><span class='def-CommentContent def-Comment def-Syntax'>,</span><span class='def-CommentDoc def-Comment def-Syntax'> left or right</span><span class='def-CommentContent def-Comment def-Syntax'>,</span><span class='def-CommentDoc def-Comment def-Syntax'> no diagonal moves allowed.</span>
 29: <span class='def-CommentDoc def-Comment def-Syntax'> */</span>
 30: <span class='def-Keyword'>fun</span> findPath<span class='def-Symbol'>(</span>maze <span class='def-SymbolStrong def-Symbol'>:</span> Maze<span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>MutableList</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>?</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 31:   <span class='def-Keyword'>val</span> previous <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>HashMap</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
 32: 
 33:   <span class='def-Keyword'>val</span> queue <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>LinkedList</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
 34:   <span class='def-Keyword'>val</span> visited <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>HashSet</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
 35: 
 36:   queue<span class='def-Symbol'>.</span>offer<span class='def-Symbol'>(</span>maze<span class='def-Symbol'>.</span>start<span class='def-Symbol'>)</span>
 37:   visited<span class='def-Symbol'>.</span>add<span class='def-Symbol'>(</span>maze<span class='def-Symbol'>.</span>start<span class='def-Symbol'>)</span>
 38:   <span class='def-Keyword'>while</span> <span class='def-Symbol'>(</span><span class='def-Symbol'>!</span>queue<span class='def-Symbol'>.</span>isEmpty<span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 39:     <span class='def-Keyword'>val</span> cell <span class='def-Symbol'>=</span> queue<span class='def-Symbol'>.</span>poll<span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='def-Symbol'>!</span><span class='def-Symbol'>!</span>
 40:     <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>cell <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> maze<span class='def-Symbol'>.</span>end<span class='def-Symbol'>)</span> <span class='def-Keyword'>break</span>
 41: 
 42:     <span class='def-Keyword'>for</span> <span class='def-Symbol'>(</span>newCell <span class='def-Keyword'>in</span> maze<span class='def-Symbol'>.</span>neighbors<span class='def-Symbol'>(</span>cell<span class='def-Symbol'>.</span>first<span class='def-Symbol'>,</span> cell<span class='def-Symbol'>.</span>second<span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 43:       <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>newCell <span class='def-Keyword'>in</span> visited<span class='def-Symbol'>)</span> <span class='def-Keyword'>continue</span>
 44:       previous<span class='def-Symbol'>.</span>put<span class='def-Symbol'>(</span>newCell<span class='def-Symbol'>,</span> cell<span class='def-Symbol'>)</span>
 45:       queue<span class='def-Symbol'>.</span>offer<span class='def-Symbol'>(</span>newCell<span class='def-Symbol'>)</span>
 46:       visited<span class='def-Symbol'>.</span>add<span class='def-Symbol'>(</span>cell<span class='def-Symbol'>)</span>
 47:     <span class='def-SymbolStrong def-Symbol'>}</span>
 48:   <span class='def-SymbolStrong def-Symbol'>}</span>
 49: 
 50:   <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>previous<span class='def-Symbol'>[</span>maze<span class='def-Symbol'>.</span>end<span class='def-Symbol'>]</span> <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> <span class='def-Keyword'>null</span><span class='def-Symbol'>)</span> <span class='def-Keyword'>return</span> <span class='def-Keyword'>null</span>
 51: 
 52:   <span class='def-Keyword'>val</span> path <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>ArrayList</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
 53:   <span class='def-Keyword'>var</span> current <span class='def-Symbol'>=</span> previous<span class='def-Symbol'>[</span>maze<span class='def-Symbol'>.</span>end<span class='def-Symbol'>]</span>
 54:   <span class='def-Keyword'>while</span> <span class='def-Symbol'>(</span>current <span class='def-Symbol'>!</span><span class='def-Symbol'>=</span> maze<span class='def-Symbol'>.</span>start<span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 55:     path<span class='def-Symbol'>.</span>add<span class='def-Symbol'>(</span><span class='def-NumberDec def-Number'>0</span><span class='def-Symbol'>,</span> current<span class='def-Symbol'>!</span><span class='def-Symbol'>!</span><span class='def-Symbol'>)</span>
 56:     current <span class='def-Symbol'>=</span> previous<span class='def-Symbol'>[</span>current<span class='def-Symbol'>]</span>
 57:   <span class='def-SymbolStrong def-Symbol'>}</span>
 58:   <span class='def-Keyword'>return</span> path
 59: <span class='def-SymbolStrong def-Symbol'>}</span>
 60: 
 61: <span class='def-CommentDoc def-Comment def-Syntax'>/**</span>
 62: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> Find neighbors of the (i</span><span class='def-CommentContent def-Comment def-Syntax'>,</span><span class='def-CommentDoc def-Comment def-Syntax'> j) cell that are not walls</span>
 63: <span class='def-CommentDoc def-Comment def-Syntax'> */</span>
 64: <span class='def-Keyword'>fun</span> Maze<span class='def-Symbol'>.</span>neighbors<span class='def-Symbol'>(</span>i <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> j <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>MutableList</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span> <span class='def-SymbolStrong def-Symbol'>{</span>
 65:   <span class='def-Keyword'>val</span> result <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>ArrayList</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
 66:   addIfFree<span class='def-Symbol'>(</span>i <span class='def-Symbol'>-</span> <span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>,</span> j<span class='def-Symbol'>,</span> result<span class='def-Symbol'>)</span>
 67:   addIfFree<span class='def-Symbol'>(</span>i<span class='def-Symbol'>,</span> j <span class='def-Symbol'>-</span> <span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>,</span> result<span class='def-Symbol'>)</span>
 68:   addIfFree<span class='def-Symbol'>(</span>i <span class='def-Symbol'>+</span> <span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>,</span> j<span class='def-Symbol'>,</span> result<span class='def-Symbol'>)</span>
 69:   addIfFree<span class='def-Symbol'>(</span>i<span class='def-Symbol'>,</span> j <span class='def-Symbol'>+</span> <span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>,</span> result<span class='def-Symbol'>)</span>
 70:   <span class='def-Keyword'>return</span> result
 71: <span class='def-SymbolStrong def-Symbol'>}</span>
 72: 
 73: <span class='def-Keyword'>fun</span> Maze<span class='def-Symbol'>.</span>addIfFree<span class='def-Symbol'>(</span>i <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> j <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> result <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>MutableList</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 74:   <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>i <span class='def-Symbol'>!</span><span class='def-Keyword'>in</span> <span class='def-NumberDec def-Number'>0</span><span class='def-Symbol'>.</span><span class='def-Symbol'>.</span>height<span class='def-Symbol'>-</span><span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>)</span> <span class='def-Keyword'>return</span>
 75:   <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>j <span class='def-Symbol'>!</span><span class='def-Keyword'>in</span> <span class='def-NumberDec def-Number'>0</span><span class='def-Symbol'>.</span><span class='def-Symbol'>.</span>width<span class='def-Symbol'>-</span><span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>)</span> <span class='def-Keyword'>return</span>
 76:   <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>walls<span class='def-Symbol'>[</span>i<span class='def-Symbol'>]</span><span class='def-Symbol'>[</span>j<span class='def-Symbol'>]</span><span class='def-Symbol'>)</span> <span class='def-Keyword'>return</span>
 77: 
 78:   result<span class='def-Symbol'>.</span>add<span class='def-Symbol'>(</span><span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>(</span>i<span class='def-Symbol'>,</span> j<span class='def-Symbol'>)</span><span class='def-Symbol'>)</span>
 79: <span class='def-SymbolStrong def-Symbol'>}</span>
 80: 
 81: <span class='def-CommentDoc def-Comment def-Syntax'>/**</span>
 82: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> A data class that represents a maze</span>
 83: <span class='def-CommentDoc def-Comment def-Syntax'> */</span>
 84: <span class='def-Keyword'>class</span> Maze<span class='def-Symbol'>(</span>
 85:     <span class='def-LineComment def-Comment def-Syntax'>// Number or columns</span>
 86:     <span class='def-Keyword'>val</span> width <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span>
 87:     <span class='def-LineComment def-Comment def-Syntax'>// Number of rows</span>
 88:     <span class='def-Keyword'>val</span> height <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span>
 89:     <span class='def-LineComment def-Comment def-Syntax'>// true for a wall, false for free space</span>
 90:     <span class='def-Keyword'>val</span> walls <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Array</span><span class='def-Symbol'>&lt;</span><span class='def-Keyword'>out</span> <span class='def-TypeKeyword def-Keyword'>Array</span><span class='def-Symbol'>&lt;</span><span class='def-Keyword'>out</span> <span class='def-TypeKeyword def-Keyword'>Boolean</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>,</span>
 91:     <span class='def-LineComment def-Comment def-Syntax'>// The starting point (must not be a wall)</span>
 92:     <span class='def-Keyword'>val</span> start <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>,</span>
 93:     <span class='def-LineComment def-Comment def-Syntax'>// The target point (must not be a wall)</span>
 94:     <span class='def-Keyword'>val</span> end <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span>
 95: <span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 96: <span class='def-SymbolStrong def-Symbol'>}</span>
 97: 
 98: <span class='def-CommentDoc def-Comment def-Syntax'>/** A few maze examples here */</span>
 99: <span class='def-Keyword'>fun</span> main<span class='def-Symbol'>(</span>args <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Array</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>String</span><span class='def-Symbol'>></span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
100:   printMaze<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>I  $</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
101:   printMaze<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>I O $</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
102:   printMaze<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
103: <span class='def-String'>    O  $</span>
104: <span class='def-String'>    O</span>
105: <span class='def-String'>    O</span>
106: <span class='def-String'>    O</span>
107: <span class='def-String'>    O           I</span>
108: <span class='def-String'>  </span><span class='def-StringEdge def-String'>"""</span><span class='def-Symbol'>)</span>
109:   printMaze<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
110: <span class='def-String'>    OOOOOOOOOOO</span>
111: <span class='def-String'>    O $       O</span>
112: <span class='def-String'>    OOOOOOO OOO</span>
113: <span class='def-String'>    O         O</span>
114: <span class='def-String'>    OOOOO OOOOO</span>
115: <span class='def-String'>    O         O</span>
116: <span class='def-String'>    O OOOOOOOOO</span>
117: <span class='def-String'>    O        OO</span>
118: <span class='def-String'>    OOOOOO   IO</span>
119: <span class='def-String'>  </span><span class='def-StringEdge def-String'>"""</span><span class='def-Symbol'>)</span>
120:   printMaze<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
121: <span class='def-String'>    OOOOOOOOOOOOOOOOO</span>
122: <span class='def-String'>    O               O</span>
123: <span class='def-String'>    O$  O           O</span>
124: <span class='def-String'>    OOOOO           O</span>
125: <span class='def-String'>    O               O</span>
126: <span class='def-String'>    O  OOOOOOOOOOOOOO</span>
127: <span class='def-String'>    O           O I O</span>
128: <span class='def-String'>    O               O</span>
129: <span class='def-String'>    OOOOOOOOOOOOOOOOO</span>
130: <span class='def-String'>  </span><span class='def-StringEdge def-String'>"""</span><span class='def-Symbol'>)</span>
131: <span class='def-SymbolStrong def-Symbol'>}</span>
132: 
133: <span class='def-LineComment def-Comment def-Syntax'>// UTILITIES</span>
134: 
135: <span class='def-Keyword'>fun</span> printMaze<span class='def-Symbol'>(</span>str <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>String</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
136:   <span class='def-Keyword'>val</span> maze <span class='def-Symbol'>=</span> makeMaze<span class='def-Symbol'>(</span>str<span class='def-Symbol'>)</span>
137: 
138:   println<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>Maze:</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
139:   <span class='def-Keyword'>val</span> path <span class='def-Symbol'>=</span> findPath<span class='def-Symbol'>(</span>maze<span class='def-Symbol'>)</span>
140:   <span class='def-Keyword'>for</span> <span class='def-Symbol'>(</span>i <span class='def-Keyword'>in</span> <span class='def-NumberDec def-Number'>0</span><span class='def-Symbol'>.</span><span class='def-Symbol'>.</span>maze<span class='def-Symbol'>.</span>height <span class='def-Symbol'>-</span> <span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
141:     <span class='def-Keyword'>for</span> <span class='def-Symbol'>(</span>j <span class='def-Keyword'>in</span> <span class='def-NumberDec def-Number'>0</span><span class='def-Symbol'>.</span><span class='def-Symbol'>.</span>maze<span class='def-Symbol'>.</span>width <span class='def-Symbol'>-</span> <span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
142:       <span class='def-Keyword'>val</span> cell <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>(</span>i<span class='def-Symbol'>,</span> j<span class='def-Symbol'>)</span>
143:       print<span class='def-Symbol'>(</span>
144:           <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>maze<span class='def-Symbol'>.</span>walls<span class='def-Symbol'>[</span>i<span class='def-Symbol'>]</span><span class='def-Symbol'>[</span>j<span class='def-Symbol'>]</span><span class='def-Symbol'>)</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>O</span><span class='def-StringEdge def-String'>"</span>
145:           <span class='def-Keyword'>else</span> <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>cell <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> maze<span class='def-Symbol'>.</span>start<span class='def-Symbol'>)</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>I</span><span class='def-StringEdge def-String'>"</span>
146:           <span class='def-Keyword'>else</span> <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>cell <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> maze<span class='def-Symbol'>.</span>end<span class='def-Symbol'>)</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>$</span><span class='def-StringEdge def-String'>"</span>
147:           <span class='def-Keyword'>else</span> <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>path <span class='def-Symbol'>!</span><span class='def-Symbol'>=</span> <span class='def-Keyword'>null</span> <span class='def-Symbol'>&amp;</span><span class='def-Symbol'>&amp;</span> path<span class='def-Symbol'>.</span>contains<span class='def-Symbol'>(</span>cell<span class='def-Symbol'>)</span><span class='def-Symbol'>)</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>~</span><span class='def-StringEdge def-String'>"</span>
148:           <span class='def-Keyword'>else</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'> </span><span class='def-StringEdge def-String'>"</span>
149:       <span class='def-Symbol'>)</span>
150:     <span class='def-SymbolStrong def-Symbol'>}</span>
151:     println<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
152:   <span class='def-SymbolStrong def-Symbol'>}</span>
153:   println<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>Result: </span><span class='def-StringEdge def-String'>"</span> <span class='def-Symbol'>+</span> <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>path <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> <span class='def-Keyword'>null</span><span class='def-Symbol'>)</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>No path</span><span class='def-StringEdge def-String'>"</span> <span class='def-Keyword'>else</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>Path found</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
154:   println<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
155: <span class='def-SymbolStrong def-Symbol'>}</span>
156: 
157: 
158: <span class='def-CommentDoc def-Comment def-Syntax'>/**</span>
159: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> A maze is encoded in the string s</span><span class='def-CommentContent def-Comment def-Syntax'>:</span><span class='def-CommentDoc def-Comment def-Syntax'> the big 'O' letters are walls.</span>
160: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> I stand where a big 'I' stands and the prize is marked with</span>
161: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> a '$' sign.</span>
162: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'></span>
163: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'> Example</span><span class='def-CommentContent def-Comment def-Syntax'>:</span><span class='def-CommentDoc def-Comment def-Syntax'></span>
164: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'></span>
165: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    OOOOOOOOOOOOOOOOO</span>
166: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O               O</span>
167: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O$  O           O</span>
168: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    OOOOO           O</span>
169: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O               O</span>
170: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O  OOOOOOOOOOOOOO</span>
171: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O           O I O</span>
172: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    O               O</span>
173: <span class='def-CommentDoc def-Comment def-Syntax'> </span><span class='def-CommentContent def-Comment def-Syntax'>*</span><span class='def-CommentDoc def-Comment def-Syntax'>    OOOOOOOOOOOOOOOOO</span>
174: <span class='def-CommentDoc def-Comment def-Syntax'> */</span>
175: <span class='def-Keyword'>fun</span> makeMaze<span class='def-Symbol'>(</span>s <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>String</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>:</span> Maze <span class='def-SymbolStrong def-Symbol'>{</span>
176:   <span class='def-Keyword'>val</span> lines <span class='def-Symbol'>=</span> s<span class='def-Symbol'>.</span>split<span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-StringContent def-String'>\n</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
177:   <span class='def-Keyword'>val</span> w <span class='def-Symbol'>=</span> max<span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>String</span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span>lines<span class='def-Symbol'>.</span>toList<span class='def-Symbol'>(</span><span class='def-Symbol'>)</span><span class='def-Symbol'>,</span> comparator<span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>String</span><span class='def-Symbol'>?</span><span class='def-Symbol'>></span> <span class='def-SymbolStrong def-Symbol'>{</span>o1<span class='def-Symbol'>,</span> o2 <span class='def-Symbol'>-</span><span class='def-Symbol'>></span>
178:     <span class='def-Keyword'>val</span> l1 <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Int</span> <span class='def-Symbol'>=</span> o1<span class='def-Symbol'>?</span><span class='def-Symbol'>.</span>size <span class='def-Symbol'>?</span><span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-NumberDec def-Number'>0</span>
179:     <span class='def-Keyword'>val</span> l2 <span class='def-Symbol'>=</span> o2<span class='def-Symbol'>?</span><span class='def-Symbol'>.</span>size <span class='def-Symbol'>?</span><span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-NumberDec def-Number'>0</span>
180:     l1 <span class='def-Symbol'>-</span> l2
181:   <span class='def-SymbolStrong def-Symbol'>}</span><span class='def-Symbol'>)</span>
182:   <span class='def-Keyword'>val</span> data <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>Array</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Array</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Boolean</span><span class='def-Symbol'>></span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span>lines<span class='def-Symbol'>.</span>size<span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span><span class='def-TypeKeyword def-Keyword'>Array</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Boolean</span><span class='def-Symbol'>></span><span class='def-Symbol'>(</span>w<span class='def-Symbol'>.</span>size<span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span><span class='def-Keyword'>false</span><span class='def-SymbolStrong def-Symbol'>}</span><span class='def-SymbolStrong def-Symbol'>}</span>
183: 
184:   <span class='def-Keyword'>var</span> start <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>?</span> <span class='def-Symbol'>=</span> <span class='def-Keyword'>null</span>
185:   <span class='def-Keyword'>var</span> end <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>&lt;</span><span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>,</span> <span class='def-TypeKeyword def-Keyword'>Int</span><span class='def-Symbol'>></span><span class='def-Symbol'>?</span> <span class='def-Symbol'>=</span> <span class='def-Keyword'>null</span>
186: 
187:   <span class='def-Keyword'>for</span> <span class='def-Symbol'>(</span>line <span class='def-Keyword'>in</span> lines<span class='def-Symbol'>.</span>indices<span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
188:     <span class='def-Keyword'>for</span> <span class='def-Symbol'>(</span>x <span class='def-Keyword'>in</span> lines<span class='def-Symbol'>[</span>line<span class='def-Symbol'>]</span><span class='def-Symbol'>.</span>indices<span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
189:       <span class='def-Keyword'>val</span> c <span class='def-Symbol'>=</span> lines<span class='def-Symbol'>[</span>line<span class='def-Symbol'>]</span><span class='def-Symbol'>[</span>x<span class='def-Symbol'>]</span>
190:       data<span class='def-Symbol'>[</span>line<span class='def-Symbol'>]</span><span class='def-Symbol'>[</span>x<span class='def-Symbol'>]</span> <span class='def-Symbol'>=</span> c <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> <span class='c-Character def-Character def-String'>'O'</span>
191:       <span class='def-Keyword'>when</span> <span class='def-Symbol'>(</span>c<span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
192:         <span class='c-Character def-Character def-String'>'I'</span> <span class='def-Symbol'>-</span><span class='def-Symbol'>></span> start <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>(</span>line<span class='def-Symbol'>,</span> x<span class='def-Symbol'>)</span>
193:         <span class='c-Character def-Character def-String'>'$'</span> <span class='def-Symbol'>-</span><span class='def-Symbol'>></span> end <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>Pair</span><span class='def-Symbol'>(</span>line<span class='def-Symbol'>,</span> x<span class='def-Symbol'>)</span>
194:         <span class='def-Keyword'>else</span> <span class='def-Symbol'>-</span><span class='def-Symbol'>></span> <span class='def-SymbolStrong def-Symbol'>{</span><span class='def-SymbolStrong def-Symbol'>}</span>
195:       <span class='def-SymbolStrong def-Symbol'>}</span>
196:     <span class='def-SymbolStrong def-Symbol'>}</span>
197:   <span class='def-SymbolStrong def-Symbol'>}</span>
198: 
199:   <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>start <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> <span class='def-Keyword'>null</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
200:     <span class='def-Keyword'>throw</span> <span class='def-TypeKeyword def-Keyword'>IllegalArgumentException</span><span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>No starting point in the maze (should be indicated with 'I')</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
201:   <span class='def-SymbolStrong def-Symbol'>}</span>
202: 
203:   <span class='def-Keyword'>if</span> <span class='def-Symbol'>(</span>end <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> <span class='def-Keyword'>null</span><span class='def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
204:     <span class='def-Keyword'>throw</span> <span class='def-TypeKeyword def-Keyword'>IllegalArgumentException</span><span class='def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>No goal point in the maze (should be indicated with a '$' sign)</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>)</span>
205:   <span class='def-SymbolStrong def-Symbol'>}</span>
206: 
207:   <span class='def-Keyword'>return</span> Maze<span class='def-Symbol'>(</span>w<span class='def-Symbol'>.</span>size<span class='def-Symbol'>,</span> lines<span class='def-Symbol'>.</span>size<span class='def-Symbol'>,</span> data<span class='def-Symbol'>,</span> start<span class='def-Symbol'>!</span><span class='def-Symbol'>!</span><span class='def-Symbol'>,</span> end<span class='def-Symbol'>!</span><span class='def-Symbol'>!</span><span class='def-Symbol'>)</span>
208: <span class='def-SymbolStrong def-Symbol'>}</span>
209: 
210: 
211: <span class='def-LineComment def-Comment def-Syntax'>// An excerpt from the Standard Library</span>
212: <span class='def-Keyword'>val</span> <span class='def-TypeKeyword def-Keyword'>String</span><span class='def-Symbol'>?</span><span class='def-Symbol'>.</span>indices <span class='def-SymbolStrong def-Symbol'>:</span> <span class='def-TypeKeyword def-Keyword'>IntRange</span> <span class='def-Keyword'>get</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span> <span class='def-Symbol'>=</span> <span class='def-TypeKeyword def-Keyword'>IntRange</span><span class='def-Symbol'>(</span><span class='def-NumberDec def-Number'>0</span><span class='def-Symbol'>,</span> <span class='def-Keyword'>this</span><span class='def-Symbol'>!</span><span class='def-Symbol'>!</span><span class='def-Symbol'>.</span>size <span class='def-Symbol'>-</span> <span class='def-NumberDec def-Number'>1</span><span class='def-Symbol'>)</span>
213: 
214: 
