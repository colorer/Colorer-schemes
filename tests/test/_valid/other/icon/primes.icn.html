 0: <span class='icon-iconComment def-Comment def-Syntax'>#</span>
 1: <span class='icon-iconComment def-Comment def-Syntax'># (c) Victor Zhumatii, OSPU</span>
 2: <span class='icon-iconComment def-Comment def-Syntax'>#</span>
 3: 
 4: <span class='icon-iconWord def-Keyword'>procedure</span> randoms <span class='def-Symbol'>(</span>n<span class='icon-iconSymb def-Symbol'>,</span> k<span class='def-Symbol'>)</span> <span class='icon-iconComment def-Comment def-Syntax'># n times random in 1..k</span>
 5:      <span class='icon-iconWord def-Keyword'>every</span> <span class='icon-iconNumb def-Number'>1</span> to n <span class='icon-iconWord def-Keyword'>do</span> <span class='icon-iconWord def-Keyword'>suspend</span> <span class='icon-iconSymb def-Symbol'>?</span> k
 6: <span class='icon-iconWord def-Keyword'>end</span>
 7: 
 8: <span class='icon-iconWord def-Keyword'>procedure</span> pow<span class='def-Symbol'>(</span>a<span class='icon-iconSymb def-Symbol'>,</span> b<span class='icon-iconSymb def-Symbol'>,</span> modLimit<span class='def-Symbol'>)</span> <span class='icon-iconComment def-Comment def-Syntax'># long a^b version</span>
 9:     powers <span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconWord def-Keyword'>list</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
10:     powers <span class='icon-iconSymb def-Symbol'>|</span><span class='icon-iconSymb def-Symbol'>|</span><span class='icon-iconSymb def-Symbol'>|</span><span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='def-Symbol'>[</span>a<span class='def-Symbol'>]</span> <span class='icon-iconComment def-Comment def-Syntax'># 0-Ð Â×¥¯¥­Í</span>
11: 
12:     <span class='icon-iconWord def-Keyword'>while</span> <span class='def-Symbol'>(</span><span class='icon-iconNumb def-Number'>2</span> <span class='icon-iconSymb def-Symbol'>^</span> <span class='def-Symbol'>(</span><span class='icon-iconSymb def-Symbol'>*</span>powers <span class='icon-iconSymb def-Symbol'>-</span><span class='icon-iconNumb def-Number'>1</span><span class='def-Symbol'>)</span> <span class='def-Symbol'>)</span> <span class='icon-iconSymb def-Symbol'>&lt;</span><span class='icon-iconSymb def-Symbol'>=</span> b <span class='icon-iconWord def-Keyword'>do</span> <span class='def-SymbolStrong def-Symbol'>{</span> 
13:         last <span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> powers<span class='def-Symbol'>[</span><span class='icon-iconSymb def-Symbol'>*</span>powers<span class='def-Symbol'>]</span><span class='icon-iconSymb def-Symbol'>;</span>
14:         powers <span class='icon-iconSymb def-Symbol'>|</span><span class='icon-iconSymb def-Symbol'>|</span><span class='icon-iconSymb def-Symbol'>|</span><span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='def-Symbol'>[</span><span class='def-Symbol'>(</span>last<span class='icon-iconSymb def-Symbol'>*</span>last<span class='def-Symbol'>)</span> <span class='icon-iconSymb def-Symbol'>%</span> modLimit<span class='def-Symbol'>]</span>
15:     <span class='def-SymbolStrong def-Symbol'>}</span>
16:     res <span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconNumb def-Number'>1</span><span class='icon-iconSymb def-Symbol'>;</span> 
17:     <span class='icon-iconComment def-Comment def-Syntax'>#-d-write("Required space for powers:", *powers)</span>
18:     <span class='icon-iconWord def-Keyword'>every</span> power <span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconSymb def-Symbol'>!</span>powers <span class='icon-iconWord def-Keyword'>do</span> <span class='def-SymbolStrong def-Symbol'>{</span>
19:         <span class='icon-iconWord def-Keyword'>if</span> <span class='def-Symbol'>(</span>b <span class='icon-iconSymb def-Symbol'>%</span> <span class='icon-iconNumb def-Number'>2</span> <span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconNumb def-Number'>1</span><span class='def-Symbol'>)</span> <span class='icon-iconWord def-Keyword'>then</span> <span class='def-SymbolStrong def-Symbol'>{</span>
20:             res <span class='icon-iconSymb def-Symbol'>*</span><span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> power<span class='icon-iconSymb def-Symbol'>;</span>
21:             res <span class='icon-iconSymb def-Symbol'>%</span><span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> modLimit<span class='icon-iconSymb def-Symbol'>;</span>
22:         <span class='def-SymbolStrong def-Symbol'>}</span>
23:         b <span class='icon-iconSymb def-Symbol'>/</span><span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconNumb def-Number'>2</span>
24:     <span class='def-SymbolStrong def-Symbol'>}</span>
25:     <span class='icon-iconWord def-Keyword'>return</span> res
26:     
27: <span class='icon-iconWord def-Keyword'>end</span>
28: 
29: <span class='icon-iconWord def-Keyword'>procedure</span> isPrime<span class='def-Symbol'>(</span>p<span class='def-Symbol'>)</span> <span class='icon-iconComment def-Comment def-Syntax'>#p mayBePrime</span>
30:     pows <span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconWord def-Keyword'>set</span><span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
31:     <span class='icon-iconWord def-Keyword'>every</span> pows <span class='icon-iconSymb def-Symbol'>+</span><span class='icon-iconSymb def-Symbol'>+</span><span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconWord def-Keyword'>set</span><span class='def-Symbol'>(</span><span class='def-Symbol'>[</span>pow <span class='def-Symbol'>(</span>randoms<span class='def-Symbol'>(</span><span class='icon-iconNumb def-Number'>40</span><span class='icon-iconSymb def-Symbol'>,</span> p<span class='icon-iconSymb def-Symbol'>-</span><span class='icon-iconNumb def-Number'>1</span><span class='def-Symbol'>)</span><span class='icon-iconSymb def-Symbol'>,</span> p<span class='icon-iconSymb def-Symbol'>-</span><span class='icon-iconNumb def-Number'>1</span><span class='icon-iconSymb def-Symbol'>,</span> p<span class='def-Symbol'>)</span><span class='def-Symbol'>]</span><span class='def-Symbol'>)</span>
32:     <span class='icon-iconWord def-Keyword'>if</span> <span class='icon-iconSymb def-Symbol'>*</span>pows <span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconNumb def-Number'>1</span> <span class='icon-iconSymb def-Symbol'>&amp;</span> <span class='icon-iconSymb def-Symbol'>!</span>pows <span class='icon-iconSymb def-Symbol'>=</span> <span class='icon-iconNumb def-Number'>1</span> <span class='icon-iconWord def-Keyword'>then</span> <span class='icon-iconWord def-Keyword'>return</span> p<span class='icon-iconSymb def-Symbol'>;</span>
33: 
34: <span class='icon-iconWord def-Keyword'>end</span>
35: 
36: <span class='icon-iconWord def-Keyword'>procedure</span> main<span class='def-Symbol'>(</span><span class='def-Symbol'>)</span>
37: <span class='icon-iconComment def-Comment def-Syntax'>#    every write ("Randoms:", randoms (10, 10))</span>
38: <span class='icon-iconComment def-Comment def-Syntax'>#    write (pow(2, 10, 10))</span>
39: <span class='icon-iconComment def-Comment def-Syntax'>#    every write(pow (randoms(20, 100-1), 100-1, 100))</span>
40: <span class='icon-iconComment def-Comment def-Syntax'>#    every p := 1 to 100 do write (p, " --> ", isPrime(p+1000000000000000000) );</span>
41:     base <span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span><span class='icon-iconNumb def-Number'>10000000000000000000000000000000000000000000000000000000000000</span>
42:     <span class='icon-iconWord def-Keyword'>every</span> p <span class='icon-iconSymb def-Symbol'>:</span><span class='icon-iconSymb def-Symbol'>=</span> base <span class='icon-iconSymb def-Symbol'>+</span> <span class='def-Symbol'>(</span><span class='icon-iconNumb def-Number'>1</span> to <span class='icon-iconNumb def-Number'>100</span><span class='def-Symbol'>)</span> <span class='icon-iconWord def-Keyword'>do</span> write <span class='def-Symbol'>(</span>isPrime<span class='def-Symbol'>(</span>p<span class='def-Symbol'>)</span><span class='def-Symbol'>)</span>
43: <span class='icon-iconWord def-Keyword'>end</span>
