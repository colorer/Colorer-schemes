 0:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>HTML</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 1:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>HEAD</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 2: <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>TITLE</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>Subscription Processed Successfully<span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>TITLE</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 3:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>HEAD</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 4:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>BODY</span><span class='html-htmlUnknowParam def-ParameterUnknown def-ParameterStrong def-Parameter'> </span><span class='html-htmlParam def-Parameter'>BGCOLOR</span><span class='html-htmlTagEqu def-Symbol'>=</span><span class='html-htmlString def-String'>"#ffffff"</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 5:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>H2</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 6: Online Newsletter Subscription
 7:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>H2</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 8:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>P</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 9:  Thank You for subscribing to our newsletter!
10:  <span class='asp-OpenTag asp-Tag def-EmbeddedTag def-Tag'>&lt;%</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
11: <span class='tcltk-tclComment def-Comment def-Syntax'> # Get form data and assign to variables</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
12: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> r</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_conn form </span><span class='tcltk-tclVar def-Var'>$conn</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>
13: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> name</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_set get </span><span class='tcltk-tclVar def-Var'>$r</span> name<span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>
14: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> title</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_set get </span><span class='tcltk-tclVar def-Var'>$r</span> title<span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>
15: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> notify</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_set get </span><span class='tcltk-tclVar def-Var'>$r</span> notify<span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>
16: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> sendemail</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_set get </span><span class='tcltk-tclVar def-Var'>$r</span> sendemail<span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>
17: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> emailaddr</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_set get </span><span class='tcltk-tclVar def-Var'>$r</span> emailaddr<span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>
18: <span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
19: <span class='tcltk-tclComment def-Comment def-Syntax'> # Set subscription options explicity to 0 if not checked</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
20: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclBase def-Keyword'>if</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span><span class='tcltk-tclVar def-Var'>$notify</span> <span class='tcltk-tclSymb def-Symbol'>!</span><span class='tcltk-tclSymb def-Symbol'>=</span> <span class='def-NumberDec def-Number'>1</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span> <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> notify</span> <span class='def-NumberDec def-Number'>0</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span>
21: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclBase def-Keyword'>if</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span><span class='tcltk-tclVar def-Var'>$sendemail</span> <span class='tcltk-tclSymb def-Symbol'>!</span><span class='tcltk-tclSymb def-Symbol'>=</span> <span class='def-NumberDec def-Number'>1</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span> <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> sendemail</span> <span class='def-NumberDec def-Number'>0</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span>
22: <span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
23: <span class='tcltk-tclComment def-Comment def-Syntax'> # Update database with new subscription</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
24: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> db</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_db gethandle</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
25: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> ns_db dml </span><span class='tcltk-tclVar def-Var'>$db</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclSymb def-Symbol'>\</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
26: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>"insert into test values (</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='tcltk-tclString def-String'>ns_dbquotevalue </span><span class='tcltk-tclVar def-Var'>$name</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>,
27: <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='tcltk-tclString def-String'>ns_dbquotevalue </span><span class='tcltk-tclVar def-Var'>$title</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>, <span class='tcltk-tclVar def-Var'>$notify</span><span class='tcltk-tclString def-String'>, </span><span class='tcltk-tclVar def-Var'>$sendemail</span><span class='tcltk-tclString def-String'>,</span>
28: <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='tcltk-tclString def-String'>ns_dbquotevalue </span><span class='tcltk-tclVar def-Var'>$emailaddr</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>)"<span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
29: <span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
30: <span class='tcltk-tclComment def-Comment def-Syntax'> # Send email message to subscription administrator</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
31: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> body</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>"A new newsletter subscription was added for "</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
32: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclWord def-Keyword'>append</span><span class='tcltk-tclVar def-Var'> body</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclVar def-Var'>$name</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
33: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclWord def-Keyword'>append</span><span class='tcltk-tclVar def-Var'> body</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>". The database has been updated."</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
34: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> ns_sendmail </span><span class='tcltk-tclString def-String'>"subscript@thecompany.com"</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>"dbadmin@thecompany.com"</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
35: <span class='tcltk-tclSymb def-Symbol'>\</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
36: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>"New Subscription"</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclVar def-Var'>$body</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
37: <span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
38: <span class='tcltk-tclComment def-Comment def-Syntax'> # Send email message to user</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
39: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> body</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>"Your online newsletter subscription has been successfully</span>
40: <span class='tcltk-tclString def-String'>processed."</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
41: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> ns_sendmail </span><span class='tcltk-tclVar def-Var'>$emailaddr</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>"dbadmin@thecompany.com"</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclSymb def-Symbol'>\</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
42: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclString def-String'>"Your Online Subscription"</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclVar def-Var'>$body</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
43: <span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
44: <span class='tcltk-tclComment def-Comment def-Syntax'> # Show type of subscription to user</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
45: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclBase def-Keyword'>if</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span><span class='tcltk-tclVar def-Var'>$notify</span> <span class='tcltk-tclSymb def-Symbol'>=</span><span class='tcltk-tclSymb def-Symbol'>=</span> <span class='def-NumberDec def-Number'>1</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span> <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span>
46: ns_puts <span class='tcltk-tclString def-String'>"You will be notified via email when the online newsletter</span>
47: <span class='tcltk-tclString def-String'>changes."</span>
48:  <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span>
49: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclBase def-Keyword'>if</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span><span class='tcltk-tclVar def-Var'>$sendemail</span> <span class='tcltk-tclSymb def-Symbol'>=</span><span class='tcltk-tclSymb def-Symbol'>=</span> <span class='def-NumberDec def-Number'>1</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span> <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span>
50: ns_puts <span class='tcltk-tclString def-String'>"Future issues of the newsletter will be sent to you</span>
51: <span class='tcltk-tclString def-String'>via email."</span>
52:  <span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span>
53: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='asp-CloseTag asp-Tag def-EmbeddedTag def-Tag'>%></span>
54:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>BODY</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span><span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>HTML</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
55: 
