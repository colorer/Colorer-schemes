  0: <span class='forth-forComment def-Comment def-Syntax'>\ Additional words for working BOOTMON -- LNM 05-10-1999</span>
  1: <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>Additional words for BOOTMON</span><span class='forth-forWord def-Keyword'>"</span>
  2: include? task-instdata.fth instdata.fth
  3: include? task-configur.fth configur.fth
  4: anew task-aw.fth <span class='forth-forWord def-Keyword'>decimal</span>
  5: 
  6: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>norealize</span> <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>r@</span> new>name
  7:     <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'> - Error !!! The function </span><span class='forth-forWord def-Keyword'>"</span> id. <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'> is not realized once more !!!</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>cr</span><span class='forth-forWord def-Keyword'> ;</span>
  8: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>.h</span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>hex</span> <span class='forth-forWord def-Keyword'>.</span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>!</span><span class='forth-forWord def-Keyword'> ;</span>
  9: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>base$</span><span class='forth-forComment def-Comment def-Syntax'> ( base, &lt;number> -- N , convert next number as hex )</span>
 10:     <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>!</span> <span class='forth-forNumb def-Number'>32</span> lword number? num_type_single <span class='forth-forWord def-Keyword'>=</span> <span class='forth-forWord def-Keyword'>not</span>
 11:     <span class='forth-forWord def-Keyword'>abort" </span><span class='forth-forString def-String'>Not a single number!</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>!</span> <span class='forth-forWord def-Keyword'>state</span> <span class='forth-forWord def-Keyword'>@</span>
 12:     <span class='forth-forResWord def-Label'>IF</span> <span class='forth-forResWord def-Label'>[compile]</span> <span class='forth-forWord def-Keyword'>literal</span> <span class='forth-forResWord def-Label'>THEN</span><span class='forth-forWord def-Keyword'> ;</span>
 13: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>h#</span> <span class='forth-forNumb def-Number'>16</span> base$<span class='forth-forWord def-Keyword'> ;</span> <span class='forth-forWord def-Keyword'>immediate</span>
 14: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>d#</span> <span class='forth-forNumb def-Number'>10</span> base$<span class='forth-forWord def-Keyword'> ;</span> <span class='forth-forWord def-Keyword'>immediate</span>
 15: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>o#</span>  <span class='forth-forNumb def-Number'>8</span> base$<span class='forth-forWord def-Keyword'> ;</span> <span class='forth-forWord def-Keyword'>immediate</span>
 16: 
 17: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>leftsymbsrch</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len Symb )</span>
 18:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c@</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>=</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>leave</span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len AdrSymb )</span><span class='forth-forWord def-Keyword'> ;</span>
 19: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>left-split</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len Symb -- Adr LenSymb AdrSymb+1 Len-LenSymb-1 )</span>
 20:     <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len Symb Adr Len )</span>
 21:     leftsymbsrch
 22:     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>-</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len AdrSymb LenSymb )</span>
 23:     <span class='forth-forWord def-Keyword'>rot</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>-rot</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr LenSymb AdrSymb Len )</span>
 24:     <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>1-</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>max</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr LenSymb AdrSymb+1 Len-LenSymb-1 )</span><span class='forth-forWord def-Keyword'> ;</span>
 25: 
 26: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>rightsymbsrch</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len Symb )</span>
 27:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c@</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>=</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>leave</span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len AdrSymb )</span><span class='forth-forWord def-Keyword'> ;</span>
 28: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>right-split</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len Symb -- Adr LenSymb AdrSymb+1 Len-LenSymb-1 )</span>
 29:     <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>1-</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len Symb Adr+Len-1 Len )</span>
 30:     rightsymbsrch
 31:     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>max</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len AdrSymb LenSymb )</span>
 32:     <span class='forth-forWord def-Keyword'>rot</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>-rot</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr LenSymb AdrSymb Len )</span>
 33:     <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>1-</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>-</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr LenSymb AdrSymb+1 Len-LenSymb-1 )</span><span class='forth-forWord def-Keyword'> ;</span>
 34: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>left-parse-string</span> left-split<span class='forth-forWord def-Keyword'> ;</span>
 35: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>unaligned-@</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forNumb def-Number'>8</span> <span class='forth-forWord def-Keyword'>&lt;&lt;</span> <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forNumb def-Number'>8</span> <span class='forth-forWord def-Keyword'>c@</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forComment def-Comment def-Syntax'> ( Data )</span><span class='forth-forWord def-Keyword'> ;</span>
 36: <span class='forth-forComment def-Comment def-Syntax'>\ variable #out</span>
 37: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>lcc</span><span class='forth-forComment def-Comment def-Syntax'> ( char )</span> <span class='forth-forWord def-Keyword'>dup</span> h# <span class='forth-forNumb def-Number'>41</span> h# 5a <span class='forth-forWord def-Keyword'>between</span> <span class='forth-forResWord def-Label'>if</span> h# <span class='forth-forNumb def-Number'>20</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( char' )</span><span class='forth-forWord def-Keyword'> ;</span>
 38: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>upc</span><span class='forth-forComment def-Comment def-Syntax'> ( char )</span> <span class='forth-forWord def-Keyword'>dup</span> ascii a ascii z <span class='forth-forWord def-Keyword'>between</span> <span class='forth-forResWord def-Label'>if</span> h# <span class='forth-forNumb def-Number'>20</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( char' )</span><span class='forth-forWord def-Keyword'> ;</span>
 39: <span class='forth-forComment def-Comment def-Syntax'>\ encode string to upper registr</span>
 40: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>stupc</span><span class='forth-forComment def-Comment def-Syntax'> ( A L )</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>2dup</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c@</span> upc <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>c!</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( A L )</span><span class='forth-forWord def-Keyword'> ;</span>
 41: 
 42: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>allignhere</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span> <span class='forth-forWord def-Keyword'>here</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>mod</span> <span class='forth-forWord def-Keyword'>dup</span>
 43:     <span class='forth-forResWord def-Label'>if</span>   <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>-</span><span class='forth-forComment def-Comment def-Syntax'> ( dup ." SmGr=" . )</span>
 44:          <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forNumb def-Number'>255</span> <span class='forth-forWord def-Keyword'>c,</span> <span class='forth-forResWord def-Label'>loop</span><span class='forth-forComment def-Comment def-Syntax'> \ Aliigen for 4</span>
 45:     <span class='forth-forResWord def-Label'>else</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
 46: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>encode+</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr1 Plen1 Padr2 Plen2 -- Padr1 Plen1+len2 )</span>
 47:     ASCII <span class='forth-forWord def-Keyword'>,</span> <span class='forth-forWord def-Keyword'>rot</span> <span class='forth-forWord def-Keyword'>c!</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>c!</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr1 Plen1+len2 )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++</span>
 48: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>encode-bytes</span>  <span class='forth-forWord def-Keyword'>here</span> <span class='forth-forWord def-Keyword'>>r</span><span class='forth-forComment def-Comment def-Syntax'> ( adr len )</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c,</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c@</span> <span class='forth-forWord def-Keyword'>c,</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> (  )</span>
 49:     <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forWord def-Keyword'>here</span> <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forWord def-Keyword'>1-</span><span class='forth-forComment def-Comment def-Syntax'> ( adr len )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++</span>
 50: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>encode-string</span> <span class='forth-forWord def-Keyword'>here</span> <span class='forth-forWord def-Keyword'>>r</span><span class='forth-forComment def-Comment def-Syntax'> ( adr len )</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c,</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c@</span> <span class='forth-forWord def-Keyword'>c,</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> (  )</span>
 51:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>c,</span> <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forWord def-Keyword'>here</span> <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forWord def-Keyword'>1-</span><span class='forth-forComment def-Comment def-Syntax'> ( adr len )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++</span>
 52: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>encode-int</span><span class='forth-forComment def-Comment def-Syntax'> ( n -- Padr Plen )</span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>hex</span>
 53:    <span class='forth-forComment def-Comment def-Syntax'> \ LNM variant &lt;# 0 8 0 do # loop #> ( adr len )</span>
 54:     (.)<span class='forth-forComment def-Comment def-Syntax'> \ Classic variant</span>
 55:     <span class='forth-forExtWords def-VarStrong def-Var'>encode-bytes</span> <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++</span>
 56: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>encode-2int</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span> <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode+</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++</span>
 57: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>//string</span> <span class='forth-forWord def-Keyword'>tuck</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>r></span><span class='forth-forWord def-Keyword'> ;</span>
 58: 
 59: <span class='forth-forNumb def-Number'>15</span> <span class='forth-forWord def-Keyword'>constant</span> <span class='forth-forWordDefinition def-Keyword'>obio</span>
 60: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>decode-bytes</span><span class='forth-forComment def-Comment def-Syntax'> ( pAdr1 pLen1 dLen -- pAdr1 pLen1 dAdr dLen )</span>
 61:     <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>r@</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>r@</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forWord def-Keyword'>rot</span> <span class='forth-forWord def-Keyword'>r></span><span class='forth-forComment def-Comment def-Syntax'> ( pAdr1 pLen1 dAdr dLen )</span><span class='forth-forWord def-Keyword'> ;</span>
 62: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>decode-space</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>0=</span>
 63:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>drop</span>  obio <span class='forth-forWord def-Keyword'>exit</span> <span class='forth-forResWord def-Label'>then</span>   <span class='forth-forWord def-Keyword'>2dup</span><span class='forth-forWord def-Keyword'> " </span><span class='forth-forString def-String'>obio</span><span class='forth-forWord def-Keyword'>"</span> $=
 64:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>2drop</span> obio <span class='forth-forWord def-Keyword'>exit</span> <span class='forth-forResWord def-Label'>then</span>   <span class='forth-forWord def-Keyword'>2dup</span><span class='forth-forWord def-Keyword'> " </span><span class='forth-forString def-String'>io</span><span class='forth-forWord def-Keyword'>"</span> $=
 65:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>2drop</span> obio <span class='forth-forWord def-Keyword'>exit</span> <span class='forth-forResWord def-Label'>then</span>  <span class='forth-forComment def-Comment def-Syntax'> ( ffd2c320 )</span> <span class='forth-forWord def-Keyword'>dup</span> obio <span class='forth-forWord def-Keyword'>=</span>
 66:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>drop</span>  obio <span class='forth-forWord def-Keyword'>exit</span> <span class='forth-forResWord def-Label'>then</span>   <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forWord def-Keyword'>></span>
 67:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>Invalid address</span><span class='forth-forWord def-Keyword'>"</span> .h <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>abort</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forWord def-Keyword'> ;</span>
 68: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>decode-int</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen )</span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>hex</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>2swap</span> <span class='forth-forWord def-Keyword'>>number</span>
 69:     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>1-</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forWord def-Keyword'>2swap</span> <span class='forth-forWord def-Keyword'>drop</span>
 70:     <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr' Plen' N )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++++ 21-02-2000</span>
 71: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>decode-unit</span> ascii <span class='forth-forWord def-Keyword'>,</span> left-parse-string <span class='forth-forWord def-Keyword'>2swap</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> decode-space<span class='forth-forWord def-Keyword'> ;</span>
 72: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>decode-string</span><span class='forth-forComment def-Comment def-Syntax'> ( pAdr pLen -- pAdr' pLen' str len )</span>
 73:     <span class='forth-forWord def-Keyword'>2dup</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c@</span> <span class='forth-forWord def-Keyword'>not</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>leave</span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forResWord def-Label'>loop</span><span class='forth-forComment def-Comment def-Syntax'> ( pAdr pLen pAdr' )</span>
 74:     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>-</span><span class='forth-forComment def-Comment def-Syntax'> ( pAdr pLen pAdr' StLen )</span>
 75:     <span class='forth-forWord def-Keyword'>rot</span><span class='forth-forComment def-Comment def-Syntax'> ( pAdr pAdr' StLen pLen )</span> <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forWord def-Keyword'>1-</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2swap</span><span class='forth-forComment def-Comment def-Syntax'> ( pAdr' pLen' str len )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++++ 03-05-2000</span>
 76: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>creanewvoc</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span> <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>hex</span>
 77:     voccount <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>1+</span> voccount <span class='forth-forWord def-Keyword'>!</span>
 78:     <span class='forth-forWord def-Keyword'>&lt;#</span> voccount <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>#</span> <span class='forth-forWord def-Keyword'>#</span> <span class='forth-forWord def-Keyword'>#</span>
 79:     ascii <span class='forth-forWord def-Keyword'>-</span> <span class='forth-forWord def-Keyword'>hold</span>
 80:     ascii d <span class='forth-forWord def-Keyword'>hold</span>
 81:     ascii o <span class='forth-forWord def-Keyword'>hold</span>
 82:     ascii h <span class='forth-forWord def-Keyword'>hold</span>
 83:     ascii t <span class='forth-forWord def-Keyword'>hold</span>
 84:     ascii <span class='forth-forNumb def-Number'>e</span> <span class='forth-forWord def-Keyword'>hold</span>
 85:     ascii m <span class='forth-forWord def-Keyword'>hold</span>
 86:     <span class='forth-forWord def-Keyword'>#></span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len )</span><span class='forth-forComment def-Comment def-Syntax'> \ over over type</span>
 87:     <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forExtWords def-VarStrong def-Var'>tvocabulary</span>
 88:    <span class='forth-forComment def-Comment def-Syntax'> ( also )</span> <span class='forth-forWord def-Keyword'>evaluate</span> <span class='forth-forWord def-Keyword'>definitions</span> <span class='forth-forComment def-Comment def-Syntax'> \ Set current Voc</span>
 89:     <span class='forth-forExtWords def-VarStrong def-Var'>dictlist</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>cell+</span> voclistbase <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>-</span><span class='forth-forComment def-Comment def-Syntax'> \ Adres of pointer's of latest created vocabulary</span>
 90:     nodehandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> methvochandle <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Store PtrVoc of metod's for this node</span>
 91:     <span class='forth-forWord def-Keyword'>base</span> <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
 92: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>find_end_chain_sibling</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr )</span> <span class='forth-forResWord def-Label'>begin</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forResWord def-Label'>while</span> <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> siblinghandle <span class='forth-forResWord def-Label'>repeat</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr )</span><span class='forth-forWord def-Keyword'> ;</span>
 93: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>creaendnode</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span>
 94:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place child handle</span>
 95:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place sibling handle</span>
 96:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place property voc handle</span>
 97:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place method voc handle</span>
 98:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place adress arguments</span>
 99:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place adress inst data</span>
100:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place len inst data</span>
101:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span>    <span class='forth-forComment def-Comment def-Syntax'> \ place ihandle 1'st instance</span>
102:    <span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
103: 
104: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>makenode</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span> allignhere<span class='forth-forComment def-Comment def-Syntax'> ( -- )</span>
105:     <span class='forth-forWord def-Keyword'>here</span> code> creanode <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ store place for begining area new node</span>
106:     nodehandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>0=</span><span class='forth-forComment def-Comment def-Syntax'> \ It is 1'st node or not</span>
107:     <span class='forth-forResWord def-Label'>if</span>
108:        <span class='forth-forWord def-Keyword'>here</span> code> roothandle <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ store the base of tree</span>
109:        <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>Root of tree =</span><span class='forth-forWord def-Keyword'>"</span>
110:        <span class='forth-forWord def-Keyword'>here</span> code> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>.</span> <span class='forth-forWord def-Keyword'>,</span> <span class='forth-forComment def-Comment def-Syntax'> \ place protohandle</span>
111:        creanode <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>,</span><span class='forth-forComment def-Comment def-Syntax'> ( ? More correct variant )</span><span class='forth-forComment def-Comment def-Syntax'> \ place parent handle</span>
112:     <span class='forth-forResWord def-Label'>else</span>
113:        <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>Leaf of tree =</span><span class='forth-forWord def-Keyword'>"</span>
114:        <span class='forth-forWord def-Keyword'>here</span> code> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>.</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>,</span> <span class='forth-forComment def-Comment def-Syntax'> \ place protohandle</span>
115:        <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'> From node =</span><span class='forth-forWord def-Keyword'>"</span>
116:        nodehandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>dup</span> code> <span class='forth-forWord def-Keyword'>.</span><span class='forth-forComment def-Comment def-Syntax'> ( cr ( here AdrPtrNode PtrNode )</span> <span class='forth-forWord def-Keyword'>-rot</span>
117:        childhandle <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> 0&lt;><span class='forth-forComment def-Comment def-Syntax'> \ Have child?</span>
118:        <span class='forth-forResWord def-Label'>if</span> <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> siblinghandle find_end_chain_sibling <span class='forth-forResWord def-Label'>then</span>
119:        <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Store adres of this node as child</span>
120:        code> <span class='forth-forWord def-Keyword'>,</span><span class='forth-forComment def-Comment def-Syntax'> \ place parent handle</span>
121:     <span class='forth-forResWord def-Label'>then</span> creaendnode<span class='forth-forComment def-Comment def-Syntax'> (  )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
122: 
123: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>makeinstnode</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span> allignhere<span class='forth-forComment def-Comment def-Syntax'> ( -- )</span>
124:     <span class='forth-forWord def-Keyword'>here</span> code> creanode <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ store place for begining area new node</span>
125:     nodehandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>0=</span><span class='forth-forComment def-Comment def-Syntax'> \ It is 1'st node or not</span>
126:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>abort" </span><span class='forth-forString def-String'>Tree are absent !!!</span><span class='forth-forWord def-Keyword'>"</span>
127:     <span class='forth-forResWord def-Label'>else</span>
128:        <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>     Instance=</span><span class='forth-forWord def-Keyword'>"</span>
129:        <span class='forth-forWord def-Keyword'>here</span> code> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>.</span> nodehandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>,</span> <span class='forth-forComment def-Comment def-Syntax'> \ place protohandle</span>
130:        <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'> From node=</span><span class='forth-forWord def-Keyword'>"</span>
131:        nodehandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>.</span> >code<span class='forth-forComment def-Comment def-Syntax'> ( here AdrPtrNode PtrNode )</span>
132:        ihandle find_end_chain_sibling <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Store adres of this node as instance</span>
133:        <span class='forth-forNumb def-Number'>0</span> <span class='forth-forWord def-Keyword'>,</span><span class='forth-forComment def-Comment def-Syntax'> \ place parent handle</span>
134:     <span class='forth-forResWord def-Label'>then</span> creaendnode<span class='forth-forComment def-Comment def-Syntax'> (  )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
135: 
136: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>new-device</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span>
137:     sizedefinst <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> ( creanode @ cr ."  Node=" . )</span>
138:     save-instdata <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> \ Save inst data</span>
139:    <span class='forth-forComment def-Comment def-Syntax'> \ forth definitions ( set forth vocabulary as master )</span>
140:     ini-instproc makenode  <span class='forth-forComment def-Comment def-Syntax'> \ Create new node</span>
141:     creanode <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> nodehandle <span class='forth-forWord def-Keyword'>!</span> <span class='forth-forWord def-Keyword'>-></span> <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span> <span class='forth-forComment def-Comment def-Syntax'> \ store last defined node as current   </span>
142:     instbase <span class='forth-forWord def-Keyword'>@</span> creanode <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> adrinstdata <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Store adr of area placeing new instance data</span>
143:     creanewvoc<span class='forth-forComment def-Comment def-Syntax'> ( vocabulary for methods node )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
144: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>ihandle>phandle</span><span class='forth-forComment def-Comment def-Syntax'> ( ihandle )</span> <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( phandle )</span><span class='forth-forWord def-Keyword'> ;</span>
145: 
146: <span class='forth-forComment def-Comment def-Syntax'>\ Place string in vocabulary</span>
147: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>altovoc</span><span class='forth-forComment def-Comment def-Syntax'> ( adr len )</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c@</span> <span class='forth-forWord def-Keyword'>c,</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> (  )</span><span class='forth-forWord def-Keyword'> ;</span>
148: <span class='forth-forComment def-Comment def-Syntax'>\ Place string with her lenght at the begining in vocabulary</span>
149: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>placeinvoc</span><span class='forth-forComment def-Comment def-Syntax'> ( adr len HereAdr -- hereVoc )</span>
150:     <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c,</span><span class='forth-forComment def-Comment def-Syntax'> ( Here, adr, len )</span><span class='forth-forComment def-Comment def-Syntax'> \ Place len</span>
151:     altovoc<span class='forth-forComment def-Comment def-Syntax'> ( Here ( Store value in voc )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
152: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>placeproperty</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen Nadr Nlen -- Adr )</span>
153:     allignhere <span class='forth-forWord def-Keyword'>here</span> <span class='forth-forWord def-Keyword'>>r</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen Nadr Nlen )</span>
154:     nodehandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> prophandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>,</span><span class='forth-forComment def-Comment def-Syntax'> \ Place pointer to next property</span>
155:     <span class='forth-forWord def-Keyword'>2swap</span> <span class='forth-forWord def-Keyword'>swap</span><span class='forth-forComment def-Comment def-Syntax'> ( Nadr Nlen Plen Padr )</span>
156:     code> <span class='forth-forWord def-Keyword'>,</span><span class='forth-forComment def-Comment def-Syntax'> \ Store ptr to value property</span>
157:    <span class='forth-forComment def-Comment def-Syntax'> ( 1- )</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forWord def-Keyword'>max</span> <span class='forth-forWord def-Keyword'>,</span><span class='forth-forComment def-Comment def-Syntax'> \ Store lenght of property</span>
158:    <span class='forth-forComment def-Comment def-Syntax'> ( Nadr Nlen )</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>c,</span> altovoc allignhere<span class='forth-forComment def-Comment def-Syntax'> \ Alligen adress by 4</span>
159:     <span class='forth-forWord def-Keyword'>r></span><span class='forth-forComment def-Comment def-Syntax'> ( PPadr )</span><span class='forth-forWord def-Keyword'> ;</span>
160: <span class='forth-forComment def-Comment def-Syntax'>\ Create property</span>
161: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>attribute</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr, Plen, Nadr, Nlen -- AdrPropRec )</span>
162:     placeproperty<span class='forth-forComment def-Comment def-Syntax'> ( here )</span> code> nodehandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> prophandle <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
163: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>.properties</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span>
164:     nodehandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> prophandle <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( Phandle )</span> <span class='forth-forWord def-Keyword'>dup</span>
165:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forComment def-Comment def-Syntax'> ( Phandle )</span>
166:         <span class='forth-forResWord def-Label'>begin</span>
167:             >code <span class='forth-forWord def-Keyword'>dup</span> ptrvalprop <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> <span class='forth-forWord def-Keyword'>1+</span>
168:             <span class='forth-forWord def-Keyword'>over</span> ptrlenvalprop <span class='forth-forWord def-Keyword'>@</span>
169:             <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> ptrnameprop
170:             <span class='forth-forWord def-Keyword'>count</span> <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>type</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>=</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forWord def-Keyword'>type</span>
171:             <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>0=</span>
172:         <span class='forth-forResWord def-Label'>until</span> <span class='forth-forWord def-Keyword'>drop</span>
173:     <span class='forth-forResWord def-Label'>else</span>
174:         <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>No property defined for this node!!!</span><span class='forth-forWord def-Keyword'>"</span>
175:     <span class='forth-forResWord def-Label'>then</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
176: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>next-property</span><span class='forth-forComment def-Comment def-Syntax'> ( PreviousStr, PreviousLen, Phandle - Ap Lp T | F )</span>
177:     >code <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>0=</span>
178:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forComment def-Comment def-Syntax'> \ Is the first property in list</span>
179:         <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span><span class='forth-forComment def-Comment def-Syntax'> ( Phandle )</span> prophandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span>
180:         <span class='forth-forResWord def-Label'>if</span>  <span class='forth-forComment def-Comment def-Syntax'> \ Get first property name</span>
181:             >code ptrnameprop <span class='forth-forWord def-Keyword'>count</span>
182:         <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> \ Property list is empty</span>
183:             <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>false</span>
184:         <span class='forth-forResWord def-Label'>then</span>
185:     <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> \ We must first of all find previous property in list</span>
186:        <span class='forth-forComment def-Comment def-Syntax'> ( PreviousStr, PreviousLen, Phandle )</span>
187:         prophandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span><span class='forth-forComment def-Comment def-Syntax'> ( PtrPropList )</span>
188:         <span class='forth-forResWord def-Label'>begin</span>
189:             <span class='forth-forWord def-Keyword'>dup</span> ptrnameprop <span class='forth-forWord def-Keyword'>count</span><span class='forth-forComment def-Comment def-Syntax'> ( PtrNextProp, PtrName, Len )</span>
190:            <span class='forth-forComment def-Comment def-Syntax'> \ Comparing contents</span>
191:             <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>compare</span> <span class='forth-forWord def-Keyword'>0=</span><span class='forth-forComment def-Comment def-Syntax'> ( 1/0 )</span>
192:             <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ We are finded previous property</span>
193:                <span class='forth-forComment def-Comment def-Syntax'> ( PreviousStr, PreviousLen, PtrNextProp )</span>
194:                 <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> ptrnameprop <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span>
195:                 <span class='forth-forWord def-Keyword'>count</span> <span class='forth-forWord def-Keyword'>true</span> <span class='forth-forWord def-Keyword'>exit</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, True )</span>
196:             <span class='forth-forResWord def-Label'>then</span>
197:             <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> >code <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>0=</span><span class='forth-forComment def-Comment def-Syntax'> ( PreviousStr, PreviousLen, PtrNextProp )</span>
198:         <span class='forth-forResWord def-Label'>until</span><span class='forth-forComment def-Comment def-Syntax'> ( PreviousStr, PreviousLen, PtrNextProp )</span>
199:         <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>false</span><span class='forth-forComment def-Comment def-Syntax'> ( F )</span>
200:     <span class='forth-forResWord def-Label'>then</span><span class='forth-forWord def-Keyword'> ;</span>
201: 
202: <span class='forth-forWord def-Keyword'>variable</span> <span class='forth-forWordDefinition def-Keyword'>PrevPropPtr</span><span class='forth-forComment def-Comment def-Syntax'> \ Adres of Ptr current property</span>
203: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>eqpropname?</span><span class='forth-forComment def-Comment def-Syntax'> ( Ptrnode -- F|T )</span>
204:     <span class='forth-forWord def-Keyword'>dup</span> >code ptrnameprop <span class='forth-forWord def-Keyword'>count</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>compare</span> <span class='forth-forWord def-Keyword'>0=</span><span class='forth-forComment def-Comment def-Syntax'> ( F | T )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
205: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>delete-property</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen )</span> stupc
206:     nodehandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, Phandle )</span>
207:     prophandle <span class='forth-forWord def-Keyword'>dup</span> code> PrevPropPtr <span class='forth-forWord def-Keyword'>!</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span>
208:     <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ Property list not empty</span>
209:         eqpropname?
210:         <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ It is deleting property</span>
211:            <span class='forth-forComment def-Comment def-Syntax'> ( ,,NextPropPtr )</span> >code <span class='forth-forWord def-Keyword'>@</span> PrevPropPtr <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Delete Property</span>
212:         <span class='forth-forResWord def-Label'>else</span>
213:             <span class='forth-forResWord def-Label'>begin</span>
214:                <span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, NextPropPtr )</span> >code <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span>
215:                 <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ Working with next property</span>
216:                     eqpropname?
217:                     <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ It is deleting property</span>
218:                        <span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, PropPtr)</span>
219:                         >code <span class='forth-forWord def-Keyword'>@</span> PrevPropPtr <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> <span class='forth-forWord def-Keyword'>!</span> <span class='forth-forWord def-Keyword'>True</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, True )</span>
220:                     <span class='forth-forResWord def-Label'>else</span>
221:                         <span class='forth-forWord def-Keyword'>dup</span> PrevPropPtr <span class='forth-forWord def-Keyword'>!</span> <span class='forth-forWord def-Keyword'>false</span>
222:                        <span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, NextPropPtr, False )</span>
223:                     <span class='forth-forResWord def-Label'>then</span>
224:                 <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> \ Its end of list</span>
225:                     <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>true</span>
226:                 <span class='forth-forResWord def-Label'>then</span>
227:             <span class='forth-forResWord def-Label'>until</span>
228:         <span class='forth-forResWord def-Label'>then</span>
229:     <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> \ Empty property list</span>
230:         <span class='forth-forWord def-Keyword'>drop</span>
231:     <span class='forth-forResWord def-Label'>then</span> <span class='forth-forWord def-Keyword'>2drop</span><span class='forth-forComment def-Comment def-Syntax'> \ Drop namestring</span>
232: <span class='forth-forWord def-Keyword'>;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
233: 
234: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>ptrprop>valprop</span><span class='forth-forComment def-Comment def-Syntax'> ( ptrprop )</span> >code <span class='forth-forWord def-Keyword'>dup</span> ptrvalprop <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forWord def-Keyword'>swap</span> ptrlenvalprop <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( A L )</span><span class='forth-forWord def-Keyword'> ;</span>
235: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>getPhandleProperty</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, Phandle -- Adr Len False | True )</span>
236:     <span class='forth-forWord def-Keyword'>>r</span> stupc <span class='forth-forWord def-Keyword'>r></span>
237:     >code prophandle<span class='forth-forComment def-Comment def-Syntax'> ( dup PrevPropPtr ! )</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span>
238:     <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ Property list not empty</span>
239:         eqpropname?
240:         <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ It is finding property</span>
241:            <span class='forth-forComment def-Comment def-Syntax'> ( ,,NextPropPtr )</span><span class='forth-forComment def-Comment def-Syntax'> ( ." It's true?" cr )</span>
242:             ptrprop>valprop <span class='forth-forWord def-Keyword'>False</span>
243:         <span class='forth-forResWord def-Label'>else</span>
244:             <span class='forth-forResWord def-Label'>begin</span>
245:                <span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, NextPropPtr )</span> >code <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span>
246:                 <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ Working with next property</span>
247:                     eqpropname?
248:                     <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ It is finding property</span>
249:                        <span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, PropPtr)</span>
250:                         ptrprop>valprop <span class='forth-forWord def-Keyword'>False</span> <span class='forth-forWord def-Keyword'>True</span>
251:                        <span class='forth-forComment def-Comment def-Syntax'> ( ValAdr Len False True )</span>
252:                     <span class='forth-forResWord def-Label'>else</span>
253:                        <span class='forth-forComment def-Comment def-Syntax'> ( dup >code PrevPropPtr ! )</span> <span class='forth-forWord def-Keyword'>false</span>
254:                        <span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, NextPropPtr, False )</span>
255:                     <span class='forth-forResWord def-Label'>then</span>
256:                 <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> \ Its end of list</span>
257:                     <span class='forth-forWord def-Keyword'>true</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>dup</span>
258:                 <span class='forth-forResWord def-Label'>then</span>
259:             <span class='forth-forResWord def-Label'>until</span>
260:         <span class='forth-forResWord def-Label'>then</span>
261:     <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> \ Empty property list</span>
262:         <span class='forth-forWord def-Keyword'>true</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>true</span>
263:     <span class='forth-forResWord def-Label'>then</span>
264:     <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>roll</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>roll</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr, Len, 0/1 )</span> <span class='forth-forWord def-Keyword'>dup</span>
265:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span><span class='forth-forComment def-Comment def-Syntax'> \ Drop namestring</span>
266:     <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
267: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>get-package-property</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr NameLen Phandle -- Adr Len False | True )</span>
268:     getPhandleProperty<span class='forth-forWord def-Keyword'> ;</span>
269: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>get-my-property</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen -- Adr Len False | True )</span>
270:     stupc nodehandle <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr, NameLen, Phandle )</span>
271:     getPhandleProperty<span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
272: 
273: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>oldplace</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen PadrOldV PlenOldV PtrProperty -- AdrPropRec )</span>
274:     <span class='forth-forWord def-Keyword'>2dup</span> ptrlenvalprop <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Story new lenght</span>
275:     <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> \ Drop old lenght</span>
276:    <span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen PadrOldV )</span>
277:     <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>1-</span> <span class='forth-forWord def-Keyword'>c!</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>move</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forComment def-Comment def-Syntax'> \ Rewrite value of old property</span>
278:     <span class='forth-forWord def-Keyword'>r></span><span class='forth-forComment def-Comment def-Syntax'> ( AdrPropRec )</span><span class='forth-forWord def-Keyword'> ;</span>
279: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>newplace</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen PadrOldV PlenOldV PtrProperty -- AdrPropRec )</span>
280:     <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>pick</span> ptrlenvalprop <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Story new lenght of value property</span>
281:    <span class='forth-forComment def-Comment def-Syntax'> ( PtrProperty Padr Plen )</span>
282:     <span class='forth-forWord def-Keyword'>here</span> placeinvoc<span class='forth-forComment def-Comment def-Syntax'> ( PtrProperty Adr )</span>
283:     code> <span class='forth-forWord def-Keyword'>over</span> ptrvalprop <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> ( AdrPropRec )</span><span class='forth-forWord def-Keyword'> ;</span>
284: 
285: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>changevalueproperty</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen Nadr Nlen PadrOldV PlenOldV )</span>
286: <span class='forth-forComment def-Comment def-Syntax'>\    4 pick ( ... NewLen ) &lt; if oldplace else newplase then</span>
287:     <span class='forth-forWord def-Keyword'>2drop</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen Nadr Nlen )</span>
288:     nodehandle <span class='forth-forExtWords def-VarStrong def-Var'>@nt</span> prophandle <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen NameStr NameLen Phandle )</span>
289:     <span class='forth-forResWord def-Label'>begin</span>
290:         eqpropname? <span class='forth-forWord def-Keyword'>not</span>
291:         <span class='forth-forWord def-Keyword'>over</span> >code <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>and</span>
292:     <span class='forth-forResWord def-Label'>while</span>
293:         >code <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> \ Go to next proprty</span>
294:     <span class='forth-forResWord def-Label'>repeat</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen PtrProperty )</span> <span class='forth-forWord def-Keyword'>dup</span>
295:     <span class='forth-forResWord def-Label'>if</span>  <span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen PtrProperty )</span>
296:          >code <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>-rot</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr PtrProperty Plen PtrProperty )</span>
297:          ptrlenvalprop <span class='forth-forWord def-Keyword'>!</span> <span class='forth-forWord def-Keyword'>swap</span> code> <span class='forth-forWord def-Keyword'>swap</span> ptrvalprop <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span>
298:     <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen PtrProperty )</span>
299:          <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>abort" </span><span class='forth-forString def-String'>Error !!! Property not find in list chain</span><span class='forth-forWord def-Keyword'>"</span>
300:     <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( AdrPropRec )</span><span class='forth-forWord def-Keyword'> ;</span>
301: 
302: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>property</span><span class='forth-forComment def-Comment def-Syntax'> ( Padr, Plen, Nadr, Nlen -- AdrPropRec )</span>
303:    <span class='forth-forComment def-Comment def-Syntax'> \ cr .s</span>
304:     stupc<span class='forth-forComment def-Comment def-Syntax'> \ Name to upper registr</span>
305:    <span class='forth-forComment def-Comment def-Syntax'> \ .s 2dup space type</span>
306:     <span class='forth-forWord def-Keyword'>2dup</span> get-my-property <span class='forth-forResWord def-Label'>if</span> attribute <span class='forth-forResWord def-Label'>else</span> changevalueproperty <span class='forth-forResWord def-Label'>then</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
307: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>addproperty</span> <span class='forth-forExtWords def-VarStrong def-Var'>property</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
308: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>device-name</span><span class='forth-forComment def-Comment def-Syntax'> ( A L -- )</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'> Name=</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forWord def-Keyword'>2dup</span> <span class='forth-forWord def-Keyword'>type</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-string</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>name</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>property</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
309: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>device-type</span><span class='forth-forComment def-Comment def-Syntax'> ( A L -- )</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-string</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>device-type</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>property</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
310: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>model</span>      <span class='forth-forComment def-Comment def-Syntax'> ( A L -- )</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-string</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>model</span><span class='forth-forWord def-Keyword'>"</span>       <span class='forth-forExtWords def-VarStrong def-Var'>property</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +++</span>
311: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>set-args</span><span class='forth-forComment def-Comment def-Syntax'> ( arg-str, arg-len, reg-str, reg-len )</span>
312:     <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>reg</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>property</span><span class='forth-forComment def-Comment def-Syntax'> ( arg-str, arg-len )</span><span class='forth-forComment def-Comment def-Syntax'> \ Story Reg-str i property REG</span>
313:     placeinvoc<span class='forth-forComment def-Comment def-Syntax'> \ Place arg-ar to voc</span>
314:    <span class='forth-forComment def-Comment def-Syntax'> ( adrargstr )</span> <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span> >code adrarguments <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
315: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>izvlargs</span><span class='forth-forComment def-Comment def-Syntax'> ( node )</span> >code adrarguments <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> 0&lt;>
316:     <span class='forth-forResWord def-Label'>if</span> >code <span class='forth-forWord def-Keyword'>count</span> <span class='forth-forResWord def-Label'>else</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr, Len )</span><span class='forth-forWord def-Keyword'> ;</span>                   <span class='forth-forComment def-Comment def-Syntax'> \ +</span>
317: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>my-args</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span> <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forResWord def-Label'>if</span> izvlargs <span class='forth-forResWord def-Label'>else</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> (  )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +</span>
318: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>typechainchild</span><span class='forth-forComment def-Comment def-Syntax'> ( Pnode )</span>
319:     <span class='forth-forResWord def-Label'>begin</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forResWord def-Label'>while</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>.</span> <span class='forth-forWord def-Keyword'>space</span> >code childhandle   <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forResWord def-Label'>repeat</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +</span>
320: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>typechainsibl</span><span class='forth-forComment def-Comment def-Syntax'> ( Pnode )</span>
321:     <span class='forth-forResWord def-Label'>begin</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forResWord def-Label'>while</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>.</span> <span class='forth-forWord def-Keyword'>space</span> >code siblinghandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forResWord def-Label'>repeat</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ +</span>
322: 
323: <span class='forth-forWord def-Keyword'>c" </span><span class='forth-forString def-String'>bvfind</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forWord def-Keyword'>find</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>not</span> [IF]
324: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>bvfind</span><span class='forth-forComment def-Comment def-Syntax'> ( AdrW LenW VocPtr -- XtW 1 | endVoc 0 )</span>
325:     <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( AdrW LenW LatestTVoc )</span>
326:     <span class='forth-forResWord def-Label'>begin</span>
327:         <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> 0&lt;>
328:         <span class='forth-forResWord def-Label'>if</span> <span class='forth-forComment def-Comment def-Syntax'> ( AdrW LenW Nfa )</span>
329:             <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>count</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>compare</span> <span class='forth-forWord def-Keyword'>0=</span>
330:             <span class='forth-forResWord def-Label'>if</span> <span class='forth-forComment def-Comment def-Syntax'> ( We find it ! )</span>
331:                 <span class='forth-forWord def-Keyword'>false</span>
332:             <span class='forth-forResWord def-Label'>else</span>
333:                 <span class='forth-forWord def-Keyword'>true</span>
334:             <span class='forth-forResWord def-Label'>then</span>
335:         <span class='forth-forResWord def-Label'>else</span>
336:             <span class='forth-forWord def-Keyword'>false</span>
337:         <span class='forth-forResWord def-Label'>then</span>
338:     <span class='forth-forResWord def-Label'>while</span>
339:         prevname
340:     <span class='forth-forResWord def-Label'>repeat</span><span class='forth-forComment def-Comment def-Syntax'> ( AdrW LenW Nfa )</span>
341:     <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> 0&lt;><span class='forth-forComment def-Comment def-Syntax'> ( Nfa 1 | endVoc 0 )</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>over</span>
342:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>name></span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forWord def-Keyword'>swap</span><span class='forth-forComment def-Comment def-Syntax'> ( XtW 1 | endVoc 0 )</span><span class='forth-forWord def-Keyword'> ;</span> [THEN]
343: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>.nm</span> <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>Words-</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>count</span> <span class='forth-forWord def-Keyword'>type</span><span class='forth-forWord def-Keyword'> ;</span>
344: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>xtfindinvoc</span><span class='forth-forComment def-Comment def-Syntax'> ( Xt LNFAVoc -- Xt )</span>
345:     <span class='forth-forResWord def-Label'>begin</span>
346:         <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> 0&lt;>
347:         <span class='forth-forResWord def-Label'>if</span>
348:             <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>cell-</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> is.primitive?
349:             <span class='forth-forResWord def-Label'>if</span>
350:             <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>true</span>
351:             <span class='forth-forResWord def-Label'>else</span>
352:                 >code
353:                 <span class='forth-forResWord def-Label'>begin</span>
354:                     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> 0&lt;>
355:                     <span class='forth-forResWord def-Label'>if</span>
356:                         <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forWord def-Keyword'>=</span>
357:                         <span class='forth-forResWord def-Label'>if</span>
358:                             cr? ?pause <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>dup</span> id. tab <span class='forth-forWord def-Keyword'>true</span> <span class='forth-forWord def-Keyword'>false</span>
359:                         <span class='forth-forResWord def-Label'>else</span>
360:                             <span class='forth-forWord def-Keyword'>true</span> <span class='forth-forWord def-Keyword'>true</span>
361:                         <span class='forth-forResWord def-Label'>then</span>
362:                     <span class='forth-forResWord def-Label'>else</span>
363:                         <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( ,, 0 )</span> <span class='forth-forWord def-Keyword'>true</span> <span class='forth-forWord def-Keyword'>swap</span>
364:                     <span class='forth-forResWord def-Label'>then</span>
365:                 <span class='forth-forResWord def-Label'>while</span>
366:                     <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>cell+</span>
367:                 <span class='forth-forResWord def-Label'>repeat</span>
368:             <span class='forth-forResWord def-Label'>then</span>
369:         <span class='forth-forResWord def-Label'>else</span>
370:             <span class='forth-forWord def-Keyword'>false</span>
371:         <span class='forth-forResWord def-Label'>then</span>
372:     <span class='forth-forResWord def-Label'>while</span>
373:         prevname
374:     <span class='forth-forResWord def-Label'>repeat</span><span class='forth-forWord def-Keyword'> ;</span>
375: 
376: <span class='forth-forComment def-Comment def-Syntax'>\ Show all words that included Xt in own body</span>
377: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>.calls</span><span class='forth-forComment def-Comment def-Syntax'> ( xt -- )</span>
378:     <span class='forth-forExtWords def-VarStrong def-Var'>dictlist</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>swap</span><span class='forth-forComment def-Comment def-Syntax'> ( PtrVoc Xt )</span>
379:     <span class='forth-forResWord def-Label'>begin</span>
380:         <span class='forth-forWord def-Keyword'>over</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> 0&lt;>
381:         <span class='forth-forResWord def-Label'>if</span>
382:             <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>cell</span> <span class='forth-forNumb def-Number'>4</span> <span class='forth-forWord def-Keyword'>*</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>cr</span> <span class='forth-forWord def-Keyword'>." </span><span class='forth-forString def-String'>Voc-</span><span class='forth-forWord def-Keyword'>"</span> id.  <span class='forth-forWord def-Keyword'>cr</span>
383:             <span class='forth-forWord def-Keyword'>cell+</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>@</span> 0&lt;>
384:             <span class='forth-forResWord def-Label'>if</span> xtfindinvoc <span class='forth-forWord def-Keyword'>true</span> <span class='forth-forResWord def-Label'>else</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forResWord def-Label'>then</span>
385:         <span class='forth-forResWord def-Label'>else</span>
386:             <span class='forth-forWord def-Keyword'>false</span>
387:         <span class='forth-forResWord def-Label'>then</span>
388:     <span class='forth-forResWord def-Label'>while</span>
389:         <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>swap</span>
390:     <span class='forth-forResWord def-Label'>repeat</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>cr</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
391: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>find-method</span><span class='forth-forComment def-Comment def-Syntax'> ( MethStr MethLen Phandle -- False | Xt True )</span>
392:     >code methvochandle <span class='forth-forWord def-Keyword'>@</span> voclistbase <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( MethStr MethLen Pvoc )</span>
393:     bvfind<span class='forth-forComment def-Comment def-Syntax'> ( xt true | ptrvoc false )</span>
394:     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>0=</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( False | Xt True )</span><span class='forth-forWord def-Keyword'> ;</span>
395: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>$call-method</span><span class='forth-forComment def-Comment def-Syntax'> ( MethStr MethLen Phandle -- )</span>
396:     nodehandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>dup</span> nodehandle <span class='forth-forWord def-Keyword'>!</span>
397:     find-method<span class='forth-forComment def-Comment def-Syntax'> ( False | Xt True )</span>
398:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>execute</span>
399:     <span class='forth-forResWord def-Label'>else</span> <span class='forth-forWord def-Keyword'>abort" </span><span class='forth-forString def-String'>Sorry this method dosn't consist in this node !!!</span><span class='forth-forWord def-Keyword'>"</span>
400:     <span class='forth-forResWord def-Label'>then</span> <span class='forth-forWord def-Keyword'>r></span> nodehandle <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> (  )</span><span class='forth-forWord def-Keyword'> ;</span>
401: 
402: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>headers</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
403: 
404: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>3drop</span><span class='forth-forComment def-Comment def-Syntax'> ( i j k -- )</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> (  )</span><span class='forth-forWord def-Keyword'> ;</span>
405: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>2rot</span> <span class='forth-forComment def-Comment def-Syntax'> ( 1 2 3 4 5 6 )</span>     <span class='forth-forNumb def-Number'>5</span> <span class='forth-forWord def-Keyword'>roll</span> <span class='forth-forNumb def-Number'>5</span> <span class='forth-forWord def-Keyword'>roll</span><span class='forth-forComment def-Comment def-Syntax'> ( 3 4 5 6 1 2 )</span><span class='forth-forWord def-Keyword'> ;</span>
406: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>3rot</span> <span class='forth-forComment def-Comment def-Syntax'> ( 1 2 3 4 5 6 7 8 )</span> <span class='forth-forNumb def-Number'>7</span> <span class='forth-forWord def-Keyword'>roll</span> <span class='forth-forNumb def-Number'>7</span> <span class='forth-forWord def-Keyword'>roll</span><span class='forth-forComment def-Comment def-Syntax'> ( 3 4 5 6 7 8 1 2 )</span><span class='forth-forWord def-Keyword'> ;</span>
407: 
408: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>fcode-version2</span> h# <span class='forth-forNumb def-Number'>00020001</span><span class='forth-forWord def-Keyword'> ;</span>
409: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>fcode-revision</span> h# <span class='forth-forNumb def-Number'>00020001</span><span class='forth-forWord def-Keyword'> ;</span>
410: <span class='forth-forWord def-Keyword'>variable</span> <span class='forth-forWordDefinition def-Keyword'>fcode-debug?</span> <span class='forth-forNumb def-Number'>0</span> fcode-debug? <span class='forth-forWord def-Keyword'>!</span><span class='forth-forComment def-Comment def-Syntax'> \ Flag for debuging fcode programm</span>
411: <span class='forth-forWord def-Keyword'>variable</span> <span class='forth-forWordDefinition def-Keyword'>fcode-end</span>
412: 
413: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>scsi-selftest</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
414: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>..</span> <span class='forth-forWord def-Keyword'>.s</span><span class='forth-forComment def-Comment def-Syntax'> ( cr ." It dont worked </span><span class='def-TODO def-Error'>!!!</span><span class='forth-forComment def-Comment def-Syntax'>" )</span><span class='forth-forWord def-Keyword'> ;</span>
415: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>x+</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode+</span><span class='forth-forWord def-Keyword'> ;</span>
416: 
417: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>get-buffers</span> <span class='forth-forWord def-Keyword'>here</span> <span class='forth-forNumb def-Number'>1000</span> <span class='forth-forWord def-Keyword'>allot</span><span class='forth-forWord def-Keyword'> ;</span>
418: 
419: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>$open-package</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
420: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>close-package</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
421: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>my-parent</span><span class='forth-forComment def-Comment def-Syntax'> ( -- Inode )</span> <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span> >code parenthandle <span class='forth-forWord def-Keyword'>@</span><span class='forth-forComment def-Comment def-Syntax'> ( Inode )</span><span class='forth-forWord def-Keyword'> ;</span>
422: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>$call-parent</span><span class='forth-forComment def-Comment def-Syntax'> ( Am Lm )</span> my-parent $call-method<span class='forth-forComment def-Comment def-Syntax'> ( </span><span class='def-TODO def-Error'>???</span><span class='forth-forComment def-Comment def-Syntax'> )</span><span class='forth-forWord def-Keyword'> ;</span>
423: 
424: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>version</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
425: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>sdc</span> <span class='forth-forWord def-Keyword'>.</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
426: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>external</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
427: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>end0</span>  <span class='forth-forNumb def-Number'>00</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
428: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>end1</span> <span class='forth-forNumb def-Number'>255</span> norealize<span class='forth-forWord def-Keyword'> ;</span>
429: 
430: <span class='forth-forComment def-Comment def-Syntax'>\ For example 3-1</span>
431: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>bounds</span> <span class='forth-forNumb def-Number'>10</span><span class='forth-forWord def-Keyword'> ;</span>
432: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>#out</span> <span class='forth-forNumb def-Number'>20</span><span class='forth-forWord def-Keyword'> ;</span>
433: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>l@</span> <span class='forth-forWord def-Keyword'>@</span><span class='forth-forWord def-Keyword'> ;</span>
434: 
435: <span class='forth-forWord def-Keyword'>defer</span> b(:)<span class='forth-forComment def-Comment def-Syntax'> ( 0xb7 )</span>
436: <span class='forth-forWord def-Keyword'>decimal</span>
437: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>get-phan-inher-prop</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr NameLen node )</span>
438:     <span class='forth-forResWord def-Label'>begin</span>
439: <span class='forth-forComment def-Comment def-Syntax'>\        s" name" 2 pick get-package-property</span>
440: <span class='forth-forComment def-Comment def-Syntax'>\        not if cr ." Node=" type space then</span>
441:         <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr NameLen Inode )</span>
442:         get-package-property<span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span>
443:         <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>pick</span> >code parenthandle <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forResWord def-Label'>else</span> <span class='forth-forWord def-Keyword'>false</span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forWord def-Keyword'>and</span>
444:     <span class='forth-forResWord def-Label'>while</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr NameLen Inode )</span>
445:         <span class='forth-forWord def-Keyword'>drop</span> >code parenthandle <span class='forth-forWord def-Keyword'>@</span>
446:     <span class='forth-forResWord def-Label'>repeat</span>
447:     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forResWord def-Label'>else</span> 2rot <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>2swap</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forResWord def-Label'>then</span>
448:    <span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++</span>
449: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>get-inherited-property</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr NameLen -- Adr Len False | True )</span>
450:     <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span><span class='forth-forComment def-Comment def-Syntax'> ( NameStr NameLen Inode )</span> get-phan-inher-prop<span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span><span class='forth-forWord def-Keyword'> ;</span>
451: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>decode-physadr</span><span class='forth-forComment def-Comment def-Syntax'> ( A L -- PhysHi ...  PhysLo Aend Lend Size )</span>
452:     <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>#address-cells</span><span class='forth-forWord def-Keyword'>"</span> nodehandle <span class='forth-forWord def-Keyword'>@</span> get-phan-inher-prop<span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span>
453:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forResWord def-Label'>else</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> ( A L AC )</span> <span class='forth-forWord def-Keyword'>>r</span>
454:     <span class='forth-forWord def-Keyword'>r@</span> <span class='forth-forNumb def-Number'>0</span>   <span class='forth-forResWord def-Label'>do</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forResWord def-Label'>loop</span> 
455:     <span class='forth-forWord def-Keyword'>r@</span> <span class='forth-forNumb def-Number'>0</span>   <span class='forth-forResWord def-Label'>do</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forResWord def-Label'>loop</span> 
456:     <span class='forth-forWord def-Keyword'>r@</span> <span class='forth-forNumb def-Number'>0</span>   <span class='forth-forResWord def-Label'>do</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forResWord def-Label'>loop</span>
457:     <span class='forth-forWord def-Keyword'>r></span><span class='forth-forComment def-Comment def-Syntax'> \ For standart variant dup dup + + 1+ dup >r roll r@ roll r> roll</span>
458:    <span class='forth-forComment def-Comment def-Syntax'> ( PhysHi ...  PhysLo Aend Lend Size )</span><span class='forth-forWord def-Keyword'> ;</span>
459: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>decode-phys</span><span class='forth-forComment def-Comment def-Syntax'> ( A L -- PhysHi ...  PhysLo Aend Lend Size )</span>
460:     decode-physadr<span class='forth-forComment def-Comment def-Syntax'> ( PhysHi ...  PhysLo Aend Lend Size )</span>
461:     <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>+</span><span class='forth-forComment def-Comment def-Syntax'> \ 3 *</span>
462:     <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>1+</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>roll</span> <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>drop</span>
463:    <span class='forth-forComment def-Comment def-Syntax'> ( Aend Lend PhysHi ...  PhysLo Size )</span><span class='forth-forWord def-Keyword'> ;</span>
464: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>encode-phys</span><span class='forth-forComment def-Comment def-Syntax'> ( PhysHi ...  PhysLo Size )</span>
465:     <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>#address-cells</span><span class='forth-forWord def-Keyword'>"</span> nodehandle <span class='forth-forWord def-Keyword'>@</span> get-phan-inher-prop<span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span>
466: <span class='forth-forComment def-Comment def-Syntax'>\    br0 decode-int 1  ( N ( Ncells by adress )</span>
467:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forResWord def-Label'>else</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forResWord def-Label'>then</span>
468:     <span class='forth-forNumb def-Number'>3</span> <span class='forth-forWord def-Keyword'>*</span> <span class='forth-forWord def-Keyword'>dup</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forWord def-Keyword'>1-</span> <span class='forth-forWord def-Keyword'>roll</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forResWord def-Label'>i</span> <span class='forth-forWord def-Keyword'>roll</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode+</span> <span class='forth-forNumb def-Number'>-1</span> <span class='forth-forResWord def-Label'>+loop</span>
469:    <span class='forth-forComment def-Comment def-Syntax'> ( Padr Plen )</span><span class='forth-forWord def-Keyword'> ;</span><span class='forth-forComment def-Comment def-Syntax'> \ ++</span>
470: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>my-unit</span><span class='forth-forComment def-Comment def-Syntax'> ( -- phys.lo .... phys.hi )</span>
471:     <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>reg</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span> get-package-property<span class='forth-forComment def-Comment def-Syntax'> ( Adr Len False | True )</span>
472:     <span class='forth-forResWord def-Label'>if</span><span class='forth-forComment def-Comment def-Syntax'> \ No property "reg" defined</span>
473:         <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>#address-cells</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span> get-phan-inher-prop
474:         <span class='forth-forResWord def-Label'>if</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forResWord def-Label'>else</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forWord def-Keyword'>dup</span>
475:         <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>loop</span>  <span class='forth-forWord def-Keyword'>r@</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>loop</span>  <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>loop</span><span class='forth-forComment def-Comment def-Syntax'> \ </span><span class='def-TODO def-Error'>?????</span>
476:     <span class='forth-forResWord def-Label'>else</span><span class='forth-forComment def-Comment def-Syntax'> ( Adr Len )</span> decode-physadr <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forWord def-Keyword'>2drop</span><span class='forth-forComment def-Comment def-Syntax'> ( phys.lo .... phys.hi )</span>
477:     <span class='forth-forResWord def-Label'>then</span><span class='forth-forComment def-Comment def-Syntax'> (  phys.lo .... phys.hi )</span><span class='forth-forWord def-Keyword'> ;</span>
478: <span class='forth-forComment def-Comment def-Syntax'>\ Convert interrup to CPU inerupt</span>
479: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>intr>cpu</span><span class='forth-forWord def-Keyword'> ;</span>
480: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>reg</span><span class='forth-forComment def-Comment def-Syntax'> ( Phys.lo Phys.hi Size )</span> <span class='forth-forWord def-Keyword'>>r</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-phys</span> <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span><span class='forth-forComment def-Comment def-Syntax'> ( A1 L1 A2 L2 )</span>
481:     <span class='forth-forExtWords def-VarStrong def-Var'>encode+</span><span class='forth-forComment def-Comment def-Syntax'> ( A L )</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>reg</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>property</span><span class='forth-forComment def-Comment def-Syntax'> (  )</span><span class='forth-forWord def-Keyword'> ;</span>
482: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>name</span><span class='forth-forComment def-Comment def-Syntax'> ( adr len -- )</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-string</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>name</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>property</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
483: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>intr</span><span class='forth-forComment def-Comment def-Syntax'> ( Level Vector )</span> <span class='forth-forWord def-Keyword'>>r</span> intr>cpu <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span> <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode+</span>
484:    <span class='forth-forComment def-Comment def-Syntax'> ( adr len )</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>intr</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>property</span><span class='forth-forComment def-Comment def-Syntax'> ( -- )</span><span class='forth-forWord def-Keyword'> ;</span>
485: 
486: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>mask-lo-part</span><span class='forth-forComment def-Comment def-Syntax'> ( phis.lo .... phys.hi )</span> <span class='forth-forWord def-Keyword'>drop</span><span class='forth-forComment def-Comment def-Syntax'> ( phis.lo .... )</span><span class='forth-forWord def-Keyword'> ;</span> 
487: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>mask-hi-part</span><span class='forth-forComment def-Comment def-Syntax'> ( phis.lo .... phys.hi )</span> <span class='forth-forWord def-Keyword'>>r</span>
488:     <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>#address-cells</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forExtWords def-VarStrong def-Var'>my-self</span> get-phan-inher-prop<span class='forth-forComment def-Comment def-Syntax'> ( A L F | T )</span>
489:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forResWord def-Label'>else</span> <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forResWord def-Label'>then</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forWord def-Keyword'>&lt;&lt;</span><span class='forth-forComment def-Comment def-Syntax'> ( ( 2 component: LO &amp; HI )</span>
490:     <span class='forth-forNumb def-Number'>0</span> <span class='forth-forResWord def-Label'>do</span> <span class='forth-forWord def-Keyword'>drop</span> <span class='forth-forResWord def-Label'>loop</span> <span class='forth-forWord def-Keyword'>r></span><span class='forth-forComment def-Comment def-Syntax'> ( phis.hi )</span><span class='forth-forWord def-Keyword'> ;</span> 
491: 
492: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>my-address</span><span class='forth-forComment def-Comment def-Syntax'> ( -- phys.lo )</span> my-unit mask-lo-part<span class='forth-forComment def-Comment def-Syntax'> ( phys.lo )</span><span class='forth-forWord def-Keyword'> ;</span>
493: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>my-space</span>  <span class='forth-forComment def-Comment def-Syntax'> ( -- phys.hi )</span> my-unit mask-hi-part<span class='forth-forComment def-Comment def-Syntax'> ( phys.hi )</span><span class='forth-forWord def-Keyword'> ;</span>
494: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>>reg-spec</span><span class='forth-forComment def-Comment def-Syntax'> ( offset size -- encodereg )</span>
495:     <span class='forth-forWord def-Keyword'>>r</span> my-address <span class='forth-forWord def-Keyword'>+</span> my-space <span class='forth-forExtWords def-VarStrong def-Var'>encode-phys</span>
496:     <span class='forth-forWord def-Keyword'>r></span> <span class='forth-forExtWords def-VarStrong def-Var'>encode-int</span> <span class='forth-forExtWords def-VarStrong def-Var'>encode+</span><span class='forth-forComment def-Comment def-Syntax'> ( 2dup type ( A L )</span><span class='forth-forWord def-Keyword'> ;</span>
497: 
498: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>getnamehandleproperty</span><span class='forth-forComment def-Comment def-Syntax'> ( A L A L )</span> <span class='forth-forWord def-Keyword'>2drop</span> <span class='forth-forWord def-Keyword'>2drop</span> norealize
499:     <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>120,400000</span><span class='forth-forWord def-Keyword'>"</span><span class='forth-forComment def-Comment def-Syntax'> ( A L )</span><span class='forth-forWord def-Keyword'> ;</span>
500: <span class='forth-forWord def-Keyword'>:</span> <span class='forth-forWordDefinition def-Keyword'>btest</span><span class='forth-forComment def-Comment def-Syntax'> ( -- bit )</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>testbit</span><span class='forth-forWord def-Keyword'>"</span> get-my-property<span class='forth-forComment def-Comment def-Syntax'> ( A L F|T )</span>
501:     <span class='forth-forResWord def-Label'>if</span> <span class='forth-forWord def-Keyword'>abort" </span><span class='forth-forString def-String'>No define testbit property !!!</span><span class='forth-forWord def-Keyword'>"</span>
502:     <span class='forth-forResWord def-Label'>else</span>
503:         <span class='forth-forExtWords def-VarStrong def-Var'>decode-int</span> <span class='forth-forWord def-Keyword'>-rot</span> <span class='forth-forWord def-Keyword'>2drop</span><span class='forth-forComment def-Comment def-Syntax'> ( i )</span> <span class='forth-forWord def-Keyword'>/mod</span><span class='forth-forComment def-Comment def-Syntax'> ( i ost n )</span> <span class='forth-forNumb def-Number'>2</span> <span class='forth-forWord def-Keyword'>&lt;&lt;</span>
504:         <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>adrtestbittable</span><span class='forth-forWord def-Keyword'>"</span> <span class='forth-forWord def-Keyword'>s" </span><span class='forth-forString def-String'>/options</span><span class='forth-forWord def-Keyword'>"</span> getnamehandleproperty
505:         <span class='forth-forExtWords def-VarStrong def-Var'>encode-phys</span> <span class='forth-forWord def-Keyword'>+</span> <span class='forth-forWord def-Keyword'>@</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forNumb def-Number'>1</span> <span class='forth-forWord def-Keyword'>swap</span> <span class='forth-forWord def-Keyword'>&lt;&lt;</span> <span class='forth-forWord def-Keyword'>and</span><span class='forth-forComment def-Comment def-Syntax'> ( bit )</span>
506:     <span class='forth-forResWord def-Label'>then</span><span class='forth-forWord def-Keyword'> ;</span>
507: 
