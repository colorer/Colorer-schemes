 0:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>HTML</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 1:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>HEAD</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 2:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>TITLE</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>This is a test of ADP<span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>TITLE</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 3:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>HEAD</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 4:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>BODY</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 5:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>H1</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>This is a test of ADP<span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>H1</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
 6:  <span class='asp-OpenTag asp-Tag def-EmbeddedTag def-Tag'>&lt;%</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
 7: <span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
 8: <span class='tcltk-tclComment def-Comment def-Syntax'> ## Proxies should cache this page for a maximum of 1 hour:</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
 9: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> ns_setexpires </span><span class='tcltk-tclVar def-Var'>$conn</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='def-NumberDec def-Number'>3600</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
10: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> host</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_set iget </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>[</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>ns_conn headers </span><span class='tcltk-tclVar def-Var'>$conn</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span> host<span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>]</span>
11: <span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
12: <span class='tcltk-tclComment def-Comment def-Syntax'> ## How many times has this page been accessed</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
13: <span class='tcltk-tclComment def-Comment def-Syntax'> ## since the server was started?</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
14: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> ns_share </span><span class='tcltk-tclSymb def-Symbol'>-</span><span class='tcltk-tclParam def-Parameter'>init</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>{</span><span class='tcltk-tclBase def-Keyword'>set</span><span class='tcltk-tclVar def-Var'> count</span> <span class='def-NumberDec def-Number'>0</span><span class='tcltk-tclMainSymb def-SymbolStrong def-Symbol'>}</span> count
15: <span class='tcltk-tclVar def-Var'> </span><span class='tcltk-tclWord def-Keyword'>incr</span><span class='tcltk-tclVar def-Var'> count</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
16: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='asp-CloseTag asp-Tag def-EmbeddedTag def-Tag'>%></span>
17: 
18:  Number of accesses since server start: <span class='asp-OpenTag asp-Tag def-EmbeddedTag def-Tag'>&lt;%</span><span class='tcltk-tclSymb def-Symbol'>=</span><span class='tcltk-tclVar def-Var'>$count</span><span class='asp-CloseTag asp-Tag def-EmbeddedTag def-Tag'>%></span><span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>br</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
19:  tcl_version: <span class='asp-OpenTag asp-Tag def-EmbeddedTag def-Tag'>&lt;%</span><span class='tcltk-tclSymb def-Symbol'>=</span><span class='tcltk-tclVar def-Var'>$tcl_version</span><span class='asp-CloseTag asp-Tag def-EmbeddedTag def-Tag'>%></span><span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>br</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
20:  tcl_library: <span class='asp-OpenTag asp-Tag def-EmbeddedTag def-Tag'>&lt;%</span><span class='tcltk-tclSymb def-Symbol'>=</span><span class='tcltk-tclVar def-Var'>$tcl_library</span><span class='asp-CloseTag asp-Tag def-EmbeddedTag def-Tag'>%></span><span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>br</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
21:  Host: <span class='asp-OpenTag asp-Tag def-EmbeddedTag def-Tag'>&lt;%</span><span class='tcltk-tclSymb def-Symbol'>=</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='tcltk-tclVar def-Var'>$host</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='asp-CloseTag asp-Tag def-EmbeddedTag def-Tag'>%></span><span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>br</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
22: 
23:  <span class='html-htmlComment def-Comment def-Syntax'>&lt;!-- Include the contents of a file: --></span>
24:  <span class='asp-OpenTag asp-Tag def-EmbeddedTag def-Tag'>&lt;%</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'></span>
25: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> ns_adp_include standard</span><span class='tcltk-tclSymb def-Symbol'>-</span><span class='asp-Insertion def-InsertionEmbed def-Insertion'>header</span>
26: <span class='asp-Insertion def-InsertionEmbed def-Insertion'> </span><span class='asp-CloseTag asp-Tag def-EmbeddedTag def-Tag'>%></span>
27: 
28:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>script</span><span class='html-htmlUnknowParam def-ParameterUnknown def-ParameterStrong def-Parameter'> </span><span class='html-htmlParam def-Parameter'>language</span><span class='html-htmlTagEqu def-Symbol'>=</span><span class='html-htmlUnknowParam def-ParameterUnknown def-ParameterStrong def-Parameter'>tcl runat</span><span class='html-htmlTagEqu def-Symbol'>=</span><span class='html-htmlUnknowParam def-ParameterUnknown def-ParameterStrong def-Parameter'>server</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
29:  ## You can <span class='jScript-ES5ReservedWord def-Keyword'>do</span> recursive ADP processing as well<span class='def-SymbolStrong def-Symbol'>:</span>
30:  ns_adp_include time<span class='def-Symbol'>.</span>adp
31:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>script</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
32: 
33:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>P</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>Here's an example of streaming:
34:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>script</span><span class='html-htmlUnknowParam def-ParameterUnknown def-ParameterStrong def-Parameter'> stream</span><span class='html-htmlTagEqu def-Symbol'>=</span><span class='html-htmlUnknowParam def-ParameterUnknown def-ParameterStrong def-Parameter'>on runat</span><span class='html-htmlTagEqu def-Symbol'>=</span><span class='html-htmlString def-String'>"server"</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
35:  ns_puts <span class='def-StringEdge def-String'>"</span><span class='def-String'>&lt;br>1...&lt;br></span><span class='def-StringEdge def-String'>"</span>
36:  ns_sleep <span class='def-NumberDec def-Number'>2</span>
37:  ns_puts <span class='def-StringEdge def-String'>"</span><span class='def-String'>2...&lt;br></span><span class='def-StringEdge def-String'>"</span>
38:  ns_sleep <span class='def-NumberDec def-Number'>2</span>
39:  ns_puts <span class='def-StringEdge def-String'>"</span><span class='def-String'>3!&lt;br></span><span class='def-StringEdge def-String'>"</span>
40:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>script</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
41:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>p</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span><span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;</span><span class='html-htmlOpenTag def-Keyword'>b</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>End<span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>b</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
42:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>BODY</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
43:  <span class='html-htmlTagBr def-OpenTag def-Tag'>&lt;/</span><span class='html-htmlCloseTag html-htmlOpenTag def-Keyword'>HTML</span><span class='html-htmlTagBr def-OpenTag def-Tag'>></span>
44: 
